Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

L_inf norm |V_tpg1 - Vfine| = 2.77e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.28e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 5.61e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 1.99e-01  with # grid points: 2193
L_inf norm |V_sg1 - Vfine| = 2.77e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.24e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 5.19e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 1.40e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.42e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 1.75e-01  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 1.89e-01  with # grid points: 9345


Algorithm converged. Run-time of: 28.63 seconds.

Plotting Figures...
Running algorithm:
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('distcomp.remoteparfor/getCompleteIntervals', '/Applications/MATLAB_R2021a.app/toolbox/parallel/distcomp/+distcomp/remoteparfor.m', 379)" style="font-weight:bold">distcomp.remoteparfor/getCompleteIntervals</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/parallel/distcomp/+distcomp/remoteparfor.m',379,0)">line 379</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('parallel_function>distributed_execution', '/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m', 741)" style="font-weight:bold">parallel_function>distributed_execution</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m',741,0)">line 741</a>)
        [tags, out] = P.getCompleteIntervals(chunkSize);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('parallel_function', '/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m', 573)" style="font-weight:bold">parallel_function</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m',573,0)">line 573</a>)
    R = distributed_execution(...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('Hbasis', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/Hbasis.m', 33)" style="font-weight:bold">Hbasis</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/Hbasis.m',33,0)">line 33</a>)
    parfor i = 1:size(lvlGridGroups, 1)

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('get_projection_matrix', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/get_projection_matrix.m', 20)" style="font-weight:bold">get_projection_matrix</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/get_projection_matrix.m',20,0)">line 20</a>)
    BH_comp_nonoverlap = Hbasis(points(~overlap_bool, :), ...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 52)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',52,0)">line 52</a>)
G.BHDense = get_projection_matrix(GDense.grid, GDense.lvl, G);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

L_inf norm |V_tpg1 - Vfine| = 2.77e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.28e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 5.61e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 1.99e-01  with # grid points: 2193
L_inf norm |V_sg1 - Vfine| = 2.77e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.24e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 5.19e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 1.40e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.42e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 1.75e-01  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 1.89e-01  with # grid points: 9345


Algorithm converged. Run-time of: 39.69 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0747, K = 3.85),  markets(S = -1.33e-16,  Y-C-I = 4.18e-01, Kgap = 7.29e-01) 

Evaluating 46 points to refine on ...
Mean level of abs(aH): 27.3083. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 69, parents added: 0, 
Net change: 51 -> 120 = << 69 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0569, K = 4.84),  markets(S = 6.94e-17,  Y-C-I = 6.34e-01, Kgap = 2.66e+00) 

Evaluating 54 points to refine on ...
Mean level of abs(aH): 210.698. Maximum level of grid: 6. 
Nodes coarsened: 18, children added: 54, parents added: 1, 
Net change: 120 -> 157 = << 37 >>, blacklisted: 18. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.22e+05
Stationary Equilibrium: (r = 0.0569, K = 4.84),  markets(S = 2.60e-18,  Y-C-I = 5.67e-01, Kgap = 2.03e+00) 

Evaluating 58 points to refine on ...
Mean level of abs(aH): 191.959. Maximum level of grid: 7. 
Nodes coarsened: 34, children added: 40, parents added: 15, 
Net change: 157 -> 178 = << 21 >>, blacklisted: 51. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 5.43e+01
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 79)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',79,0)">line 79</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 79)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',79,0)">line 79</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0637, K = 4.42),  markets(S = 1.24e-16,  Y-C-I = 3.40e-01, Kgap = 2.95e-03) 

Evaluating 12 points to refine on ...
Mean level of abs(aH): 1857.56. Maximum level of grid: 4. 
Nodes coarsened: 23, children added: 7, parents added: 0, 
Net change: 51 -> 35 = << -16 >>, blacklisted: 23. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 9.30e-08
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('KF', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/KF.m', 17)" style="font-weight:bold">KF</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/KF.m',17,0)">line 17</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 42)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',42,0)">line 42</a>)
g = KF(sDense, GDense, param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 79)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',79,0)">line 79</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 79)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',79,0)">line 79</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594499. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -3.55e-18,  Y-C-I = -3.10e-12, Kgap = -3.11e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0353793. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.80e-18,  Y-C-I = -7.51e-12, Kgap = -7.53e-11) 

L_inf norm |V_tpg1 - Vfine| = 2.88e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.39e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 6.74e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 2.86e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 9.84e-02  with # grid points: 8481
L_inf norm |V_sg1 - Vfine| = 2.88e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.36e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.17e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 2.44e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 8.12e-02  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 9.87e-02  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 1.09e-01  with # grid points: 9345
L_inf norm |V_sg8 - Vfine| = 1.12e-01  with # grid points: 20737


Algorithm converged. Run-time of: 73.36 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0470, K = 5.60),  markets(S = 5.08e-20,  Y-C-I = -1.91e-10, Kgap = -1.97e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.710861. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0484, K = 5.47),  markets(S = -4.40e-20,  Y-C-I = 7.53e-14, Kgap = 7.65e-13) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.279946. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -5.27e-19,  Y-C-I = -2.93e-11, Kgap = -2.96e-10) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118631. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -6.17e-19,  Y-C-I = 3.21e-12, Kgap = 3.23e-11) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594492. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -1.12e-18,  Y-C-I = -5.08e-12, Kgap = -5.09e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.035379. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.42e-19,  Y-C-I = -4.03e-11, Kgap = -4.04e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.90e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.42e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 6.95e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.43e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.41e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 4.84e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.90e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.39e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.62e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 2.98e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.02e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 6.52e-02  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 6.47e-02  with # grid points: 9345
L_inf norm |V_sg8 - Vfine| = 6.19e-02  with # grid points: 20737
L_inf norm |V_sg9 - Vfine| = 5.89e-02  with # grid points: 45569


Algorithm converged. Run-time of: 218.54 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594499. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -3.55e-18,  Y-C-I = -3.10e-12, Kgap = -3.11e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0353793. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.80e-18,  Y-C-I = -7.51e-12, Kgap = -7.53e-11) 

L_inf norm |V_tpg1 - Vfine| = 2.91e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.43e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 6.78e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.29e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.50e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 4.74e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.91e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.38e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.40e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.01e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.17e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 6.39e-02  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 6.52e-02  with # grid points: 9345
L_inf norm |V_sg8 - Vfine| = 6.19e-02  with # grid points: 20737


Algorithm converged. Run-time of: 127.86 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594499. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -3.55e-18,  Y-C-I = -3.10e-12, Kgap = -3.11e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0353793. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.80e-18,  Y-C-I = -7.51e-12, Kgap = -7.53e-11) 

L_inf norm |V_tpg1 - Vfine| = 2.91e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.45e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.02e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.30e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.40e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 4.69e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.91e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.41e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.47e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 2.91e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.04e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 6.48e-02  with # grid points: 4161


Algorithm converged. Run-time of: 143.07 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594499. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -3.55e-18,  Y-C-I = -3.10e-12, Kgap = -3.11e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0353793. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.80e-18,  Y-C-I = -7.51e-12, Kgap = -7.53e-11) 

L_inf norm |V_tpg1 - Vfine| = 2.90e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.43e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.15e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.24e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.42e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 4.71e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.90e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.40e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.55e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 2.81e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 9.85e-02  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 6.46e-02  with # grid points: 4161


Algorithm converged. Run-time of: 142.48 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594499. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -3.55e-18,  Y-C-I = -3.10e-12, Kgap = -3.11e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0353793. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.80e-18,  Y-C-I = -7.51e-12, Kgap = -7.53e-11) 

L_inf norm |V_tpg1 - Vfine| = 2.92e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.45e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.17e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.35e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.47e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 4.95e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.92e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.41e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.63e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.00e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.14e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 6.45e-02  with # grid points: 4161


Algorithm converged. Run-time of: 221.25 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594499. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -3.55e-18,  Y-C-I = -3.10e-12, Kgap = -3.11e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0353793. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.80e-18,  Y-C-I = -7.51e-12, Kgap = -7.53e-11) 

L_inf norm |V_tpg1 - Vfine| = 2.92e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.46e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.18e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.46e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.47e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 5.09e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.92e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.42e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.68e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.03e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.18e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 6.48e-02  with # grid points: 4161


Algorithm converged. Run-time of: 345.95 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594499. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('distcomp.remoteparfor/getCompleteIntervals', '/Applications/MATLAB_R2021a.app/toolbox/parallel/distcomp/+distcomp/remoteparfor.m', 379)" style="font-weight:bold">distcomp.remoteparfor/getCompleteIntervals</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/parallel/distcomp/+distcomp/remoteparfor.m',379,0)">line 379</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('parallel_function>distributed_execution', '/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m', 741)" style="font-weight:bold">parallel_function>distributed_execution</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m',741,0)">line 741</a>)
        [tags, out] = P.getCompleteIntervals(chunkSize);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('parallel_function', '/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m', 573)" style="font-weight:bold">parallel_function</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m',573,0)">line 573</a>)
    R = distributed_execution(...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('Hbasis', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/Hbasis.m', 33)" style="font-weight:bold">Hbasis</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/Hbasis.m',33,0)">line 33</a>)
    parfor i = 1:size(lvlGridGroups, 1)

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('get_projection_matrix', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/get_projection_matrix.m', 20)" style="font-weight:bold">get_projection_matrix</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/get_projection_matrix.m',20,0)">line 20</a>)
    BH_comp_nonoverlap = Hbasis(points(~overlap_bool, :), ...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 98)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',98,0)">line 98</a>)
    G.BHDense = get_projection_matrix(GDense.grid, GDense.lvl, G);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594499. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -3.55e-18,  Y-C-I = -3.10e-12, Kgap = -3.11e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0353793. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.80e-18,  Y-C-I = -7.51e-12, Kgap = -7.53e-11) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_H_mat2', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_H_mat2.m', 46)" style="font-weight:bold">gen_H_mat2</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_H_mat2.m',46,0)">line 46</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_FD_interior', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD_interior.m', 18)" style="font-weight:bold">gen_FD_interior</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD_interior.m',18,0)">line 18</a>)
    [~, boundHk] = gen_H_mat2(boundGrid, boundLvl, k);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_derived_fields', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m', 23)" style="font-weight:bold">gen_derived_fields</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m',23,0)">line 23</a>)
    G = gen_FD_interior(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('setup_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m', 51)" style="font-weight:bold">setup_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m',51,0)">line 51</a>)
G = gen_derived_fields(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 110)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',110,0)">line 110</a>)
GFine = setup_grid(0, param.surplusFine, param.min, param.max, 'named_dims', {1,2},
'names', {'k','z'}, 'dxx_dims', 2);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594499. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -3.55e-18,  Y-C-I = -3.10e-12, Kgap = -3.11e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0353793. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.80e-18,  Y-C-I = -7.51e-12, Kgap = -7.53e-11) 

L_inf norm |V_tpg1 - Vfine| = 2.90e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.43e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 6.91e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.14e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.41e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 4.20e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.90e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.40e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.22e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 2.88e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.09e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 6.17e-02  with # grid points: 4161


Algorithm converged. Run-time of: 51.50 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594499. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -3.55e-18,  Y-C-I = -3.10e-12, Kgap = -3.11e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0353793. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.80e-18,  Y-C-I = -7.51e-12, Kgap = -7.53e-11) 

L_inf norm |V_tpg1 - Vfine| = 2.90e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.43e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 6.91e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.14e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.41e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 4.20e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.90e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.40e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.22e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 2.88e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.09e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 6.17e-02  with # grid points: 4161


Algorithm converged. Run-time of: 52.01 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0750, K = 3.83),  markets(S = 1.12e-16,  Y-C-I = 4.07e-01, Kgap = 6.55e-01) 

Evaluating 43 points to refine on ...
Mean level of abs(aH): 54.3399. Maximum level of grid: 5. 
Nodes coarsened: 3, children added: 61, parents added: 0, 
Net change: 51 -> 109 = << 58 >>, blacklisted: 3. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0572, K = 4.82),  markets(S = -7.63e-17,  Y-C-I = 6.27e-01, Kgap = 2.59e+00) 

Evaluating 54 points to refine on ...
Mean level of abs(aH): 225.555. Maximum level of grid: 6. 
Nodes coarsened: 7, children added: 54, parents added: 1, 
Net change: 109 -> 157 = << 48 >>, blacklisted: 10. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.50e+06
Stationary Equilibrium: (r = 0.0572, K = 4.82),  markets(S = 8.67e-19,  Y-C-I = 5.65e-01, Kgap = 2.01e+00) 

Evaluating 61 points to refine on ...
Mean level of abs(aH): 176.785. Maximum level of grid: 7. 
Nodes coarsened: 32, children added: 46, parents added: 19, 
Net change: 157 -> 190 = << 33 >>, blacklisted: 41. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0670, K = 4.23),  markets(S = 1.82e-08,  Y-C-I = 3.34e-01, Kgap = 3.08e-05) 

Evaluating 168 points to refine on ...
Mean level of abs(aH): 49.1285. Maximum level of grid: 8. 
Nodes coarsened: 3, children added: 202, parents added: 20, 
Net change: 190 -> 409 = << 219 >>, blacklisted: 44. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0578, K = 4.78),  markets(S = -1.99e-16,  Y-C-I = 1.49e+00, Kgap = 4.48e+00) 

Evaluating 355 points to refine on ...
Mean level of abs(aH): 11.4483. Maximum level of grid: 9. 
Nodes coarsened: 39, children added: 470, parents added: 34, 
Net change: 409 -> 874 = << 465 >>, blacklisted: 83. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.35e-02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 9.78e+01
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 4.44e+01
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 3.80e+01
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.16e+00
Stationary Equilibrium: (r = 0.0578, K = 4.78),  markets(S = 6.40e-18,  Y-C-I = 1.50e+00, Kgap = 4.51e+00) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('vec_x_spijs', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/vec_x_spijs.m', 16)" style="font-weight:bold">vec_x_spijs</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/vec_x_spijs.m',16,0)">line 16</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('FDoperator', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/FDoperator.m', 28)" style="font-weight:bold">FDoperator</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/FDoperator.m',28,0)">line 28</a>)
                   vec_x_spijs(MU(:,i) .* (MU(:,i) <  0), G.(['DSijs_',
                   BC_name]).D1B{k})];

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 15)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',15,0)">line 15</a>)
[Ak, const_k] = FDoperator(G, hjb.s, zeros(G.J,1), 1);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 114)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',114,0)">line 114</a>)
[~,~,~,ssFine] = stationary([ss.K, ss.tau], GFine, GDense, param);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0639, K = 4.41),  markets(S = -6.02e-17,  Y-C-I = 3.40e-01, Kgap = 2.39e-03) 

Evaluating 12 points to refine on ...
Mean level of abs(aH): 2001.46. Maximum level of grid: 4. 
Nodes coarsened: 23, children added: 7, parents added: 0, 
Net change: 51 -> 35 = << -16 >>, blacklisted: 23. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 7.36e-08
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
Complex values in VFI: terminating process.Complex values in VFI: terminating process.Complex values in VFI: terminating process.Complex values in VFI: terminating process.Stationary Equilibrium: (r = -4813872553.7046, K = -0.00),  markets(S = -3.40e+05,  Y-C-I = -3.40e+05, Kgap = -2.22e-16) 

Evaluating 0 points to refine on ...
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('mpower', '/Applications/MATLAB_R2021a.app/toolbox/matlab/ops/mpower.m', 51)" style="font-weight:bold"> ^ </a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/matlab/ops/mpower.m',51,0)">line 51</a>)
Incorrect dimensions for raising a matrix to a power. Check that the matrix is square and
the power is a scalar. To perform elementwise matrix powers, use '.^'.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('add_parents>find_parents', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m', 63)" style="font-weight:bold">add_parents>find_parents</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m',63,0)">line 63</a>)
    nmax = 2^maxl;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('add_parents', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m', 4)" style="font-weight:bold">add_parents</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m',4,0)">line 4</a>)
    [parentMat, fullGridVec, lVec] = find_parents(maxl);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('adapt_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/adapt_grid.m', 110)" style="font-weight:bold">adapt_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/adapt_grid.m',110,0)">line 110</a>)
    [parents, parentLevels] = add_parents(gridNew, lvlNew);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 92)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',92,0)">line 92</a>)
    [G, BH_adapt, blacklist, stats] = adapt_grid(G, ss.V, blacklist, ...
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0637, K = 4.42),  markets(S = 1.24e-16,  Y-C-I = 3.40e-01, Kgap = 2.95e-03) 

Evaluating 12 points to refine on ...
Mean level of abs(aH): 1857.56. Maximum level of grid: 4. 
Nodes coarsened: 23, children added: 7, parents added: 0, 
Net change: 51 -> 35 = << -16 >>, blacklisted: 23. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 9.30e-08
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_FD', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD.m', 152)" style="font-weight:bold">gen_FD</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD.m',152,0)">line 152</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 27)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',27,0)">line 27</a>)
GDense = gen_FD(GDense, BC);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 79)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',79,0)">line 79</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 79)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',79,0)">line 79</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0469, K = 5.61),  markets(S = -4.07e-18,  Y-C-I = -1.67e-13, Kgap = -1.72e-12) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.710095. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -6.96e-19,  Y-C-I = 2.79e-13, Kgap = 2.83e-12) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280048. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0491, K = 5.42),  markets(S = -8.54e-19,  Y-C-I = -4.58e-13, Kgap = -4.62e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118624. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = 7.32e-19,  Y-C-I = 4.01e-12, Kgap = 4.03e-11) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594423. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -1.12e-18,  Y-C-I = 1.02e-11, Kgap = 1.02e-10) 

Evaluating 605 points to refine on ...
Mean level of abs(aH): 0.0353737. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = 4.34e-19,  Y-C-I = 2.10e-11, Kgap = 2.10e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.90e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.43e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 6.91e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.14e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.41e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 4.20e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.90e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.40e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.22e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 2.87e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.09e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 6.17e-02  with # grid points: 4161


Algorithm converged. Run-time of: 42.52 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0469, K = 5.61),  markets(S = -4.07e-18,  Y-C-I = -1.67e-13, Kgap = -1.72e-12) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.710095. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -6.96e-19,  Y-C-I = 2.79e-13, Kgap = 2.83e-12) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280048. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0491, K = 5.42),  markets(S = -8.54e-19,  Y-C-I = -4.58e-13, Kgap = -4.62e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118624. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = 7.32e-19,  Y-C-I = 4.01e-12, Kgap = 4.03e-11) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594423. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -1.12e-18,  Y-C-I = 1.02e-11, Kgap = 1.02e-10) 

Evaluating 605 points to refine on ...
Mean level of abs(aH): 0.0353737. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = 4.34e-19,  Y-C-I = 2.10e-11, Kgap = 2.10e-10) 

Evaluating 750 points to refine on ...
Mean level of abs(aH): 0.0262192. Maximum level of grid: 10. 
Nodes coarsened: 45, children added: 390, parents added: 95, 
Net change: 1448 -> 1888 = << 440 >>, blacklisted: 119. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.25e-18,  Y-C-I = 7.95e-11, Kgap = 7.97e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.92e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.46e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.12e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.37e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.64e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 6.42e-02  with # grid points: 33345
L_inf norm |V_tpg7 - Vfine| = 2.29e-02  with # grid points: 132225
L_inf norm |V_sg1 - Vfine| = 2.92e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.42e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.45e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.10e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.32e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 4.85e-02  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 4.51e-02  with # grid points: 9345


Algorithm converged. Run-time of: 147.58 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0469, K = 5.61),  markets(S = -4.07e-18,  Y-C-I = -1.67e-13, Kgap = -1.72e-12) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.710095. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -6.96e-19,  Y-C-I = 2.79e-13, Kgap = 2.83e-12) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280048. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0491, K = 5.42),  markets(S = -8.54e-19,  Y-C-I = -4.58e-13, Kgap = -4.62e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118624. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = 7.32e-19,  Y-C-I = 4.01e-12, Kgap = 4.03e-11) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594423. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -1.12e-18,  Y-C-I = 1.02e-11, Kgap = 1.02e-10) 

Evaluating 605 points to refine on ...
Mean level of abs(aH): 0.0353737. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = 4.34e-19,  Y-C-I = 2.10e-11, Kgap = 2.10e-10) 

Evaluating 750 points to refine on ...
Mean level of abs(aH): 0.0262192. Maximum level of grid: 10. 
Nodes coarsened: 45, children added: 390, parents added: 95, 
Net change: 1448 -> 1888 = << 440 >>, blacklisted: 119. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.25e-18,  Y-C-I = 7.95e-11, Kgap = 7.97e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.92e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.46e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.33e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.58e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.63e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 6.94e-02  with # grid points: 33345
L_inf norm |V_tpg7 - Vfine| = 2.46e-02  with # grid points: 132225
L_inf norm |V_sg1 - Vfine| = 2.92e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.42e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.77e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.10e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.24e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 4.85e-02  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 4.61e-02  with # grid points: 9345


Algorithm converged. Run-time of: 611.41 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0469, K = 5.61),  markets(S = -4.07e-18,  Y-C-I = -1.67e-13, Kgap = -1.72e-12) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.710095. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -6.96e-19,  Y-C-I = 2.79e-13, Kgap = 2.83e-12) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280048. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0491, K = 5.42),  markets(S = -8.54e-19,  Y-C-I = -4.58e-13, Kgap = -4.62e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118624. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = 7.32e-19,  Y-C-I = 4.01e-12, Kgap = 4.03e-11) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594423. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -1.12e-18,  Y-C-I = 1.02e-11, Kgap = 1.02e-10) 

Evaluating 605 points to refine on ...
Mean level of abs(aH): 0.0353737. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = 4.34e-19,  Y-C-I = 2.10e-11, Kgap = 2.10e-10) 

Evaluating 750 points to refine on ...
Mean level of abs(aH): 0.0262192. Maximum level of grid: 10. 
Nodes coarsened: 45, children added: 390, parents added: 95, 
Net change: 1448 -> 1888 = << 440 >>, blacklisted: 119. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.25e-18,  Y-C-I = 7.95e-11, Kgap = 7.97e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.93e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.47e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.23e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.49e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.76e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 7.65e-02  with # grid points: 33345
L_inf norm |V_tpg7 - Vfine| = 3.51e-02  with # grid points: 132225
L_inf norm |V_sg1 - Vfine| = 2.93e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.43e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.57e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.23e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.45e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 5.95e-02  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 3.72e-02  with # grid points: 9345


Algorithm converged. Run-time of: 618.68 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0469, K = 5.61),  markets(S = -4.07e-18,  Y-C-I = -1.67e-13, Kgap = -1.72e-12) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.710095. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -6.96e-19,  Y-C-I = 2.79e-13, Kgap = 2.83e-12) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280048. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0491, K = 5.42),  markets(S = -8.54e-19,  Y-C-I = -4.58e-13, Kgap = -4.62e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118624. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = 7.32e-19,  Y-C-I = 4.01e-12, Kgap = 4.03e-11) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594423. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -1.12e-18,  Y-C-I = 1.02e-11, Kgap = 1.02e-10) 

Evaluating 605 points to refine on ...
Mean level of abs(aH): 0.0353737. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = 4.34e-19,  Y-C-I = 2.10e-11, Kgap = 2.10e-10) 

Evaluating 750 points to refine on ...
Mean level of abs(aH): 0.0262192. Maximum level of grid: 10. 
Nodes coarsened: 45, children added: 390, parents added: 95, 
Net change: 1448 -> 1888 = << 440 >>, blacklisted: 119. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.25e-18,  Y-C-I = 7.95e-11, Kgap = 7.97e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.92e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.46e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.12e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.37e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.64e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 6.42e-02  with # grid points: 33345
L_inf norm |V_tpg7 - Vfine| = 2.29e-02  with # grid points: 132225
L_inf norm |V_sg1 - Vfine| = 2.92e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.42e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.45e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.10e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.32e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 4.85e-02  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 4.51e-02  with # grid points: 9345


Algorithm converged. Run-time of: 136.72 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0469, K = 5.61),  markets(S = -4.07e-18,  Y-C-I = -1.67e-13, Kgap = -1.72e-12) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.710095. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -6.96e-19,  Y-C-I = 2.79e-13, Kgap = 2.83e-12) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280048. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0491, K = 5.42),  markets(S = -8.54e-19,  Y-C-I = -4.58e-13, Kgap = -4.62e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118624. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = 7.32e-19,  Y-C-I = 4.01e-12, Kgap = 4.03e-11) 

Evaluating 438 points to refine on ...
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('distcomp.remoteparfor/awaitCompletionDisplayingOutput', '/Applications/MATLAB_R2021a.app/toolbox/parallel/distcomp/+distcomp/remoteparfor.m', 496)" style="font-weight:bold">distcomp.remoteparfor/awaitCompletionDisplayingOutput</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/parallel/distcomp/+distcomp/remoteparfor.m',496,0)">line 496</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('distcomp.remoteparfor/complete', '/Applications/MATLAB_R2021a.app/toolbox/parallel/distcomp/+distcomp/remoteparfor.m', 365)" style="font-weight:bold">distcomp.remoteparfor/complete</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/parallel/distcomp/+distcomp/remoteparfor.m',365,0)">line 365</a>)
            obj.awaitCompletionDisplayingOutput();

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('parallel_function>distributed_execution', '/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m', 764)" style="font-weight:bold">parallel_function>distributed_execution</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m',764,0)">line 764</a>)
P.complete(false);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('parallel_function', '/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m', 573)" style="font-weight:bold">parallel_function</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/matlab/lang/parallel_function.m',573,0)">line 573</a>)
    R = distributed_execution(...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('Hbasis', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/Hbasis.m', 33)" style="font-weight:bold">Hbasis</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/Hbasis.m',33,0)">line 33</a>)
    parfor i = 1:size(lvlGridGroups, 1)

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('get_projection_matrix', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/get_projection_matrix.m', 20)" style="font-weight:bold">get_projection_matrix</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/get_projection_matrix.m',20,0)">line 20</a>)
    BH_comp_nonoverlap = Hbasis(points(~overlap_bool, :), ...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_bound_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_bound_grid.m', 50)" style="font-weight:bold">gen_bound_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_bound_grid.m',50,0)">line 50</a>)
boundGridCell.BHComp = get_projection_matrix(boundGridAll, boundLvlAll, G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_derived_fields', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m', 22)" style="font-weight:bold">gen_derived_fields</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m',22,0)">line 22</a>)
    G = gen_bound_grid(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('update_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/update_grid.m', 10)" style="font-weight:bold">update_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/update_grid.m',10,0)">line 10</a>)
G = gen_derived_fields(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('adapt_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/adapt_grid.m', 126)" style="font-weight:bold">adapt_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/adapt_grid.m',126,0)">line 126</a>)
    G = update_grid(G, gridNew, lvlNew);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 98)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',98,0)">line 98</a>)
    [G, BH_adapt, blacklist, stats] = adapt_grid(G, ss.V, blacklist, ...
} 
Parallel pool using the 'local' profile is shutting down.
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0469, K = 5.61),  markets(S = -4.07e-18,  Y-C-I = -1.67e-13, Kgap = -1.72e-12) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.710095. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -6.96e-19,  Y-C-I = 2.79e-13, Kgap = 2.83e-12) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280048. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0491, K = 5.42),  markets(S = -8.54e-19,  Y-C-I = -4.58e-13, Kgap = -4.62e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118624. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = 7.32e-19,  Y-C-I = 4.01e-12, Kgap = 4.03e-11) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594423. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -1.12e-18,  Y-C-I = 1.02e-11, Kgap = 1.02e-10) 

Evaluating 605 points to refine on ...
Mean level of abs(aH): 0.0353737. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = 4.34e-19,  Y-C-I = 2.10e-11, Kgap = 2.10e-10) 

Evaluating 750 points to refine on ...
Mean level of abs(aH): 0.0262192. Maximum level of grid: 10. 
Nodes coarsened: 45, children added: 390, parents added: 95, 
Net change: 1448 -> 1888 = << 440 >>, blacklisted: 119. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.25e-18,  Y-C-I = 7.95e-11, Kgap = 7.97e-10) 

Evaluating 935 points to refine on ...
Mean level of abs(aH): 0.0201206. Maximum level of grid: 11. 
Nodes coarsened: 137, children added: 493, parents added: 188, 
Net change: 1888 -> 2432 = << 544 >>, blacklisted: 240. 


 -------  GRID ADAPTATION ITERATION 8  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.36e-18,  Y-C-I = 9.18e-11, Kgap = 9.20e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.93e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.47e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.23e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.49e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.76e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 7.65e-02  with # grid points: 33345
L_inf norm |V_tpg7 - Vfine| = 3.51e-02  with # grid points: 132225
L_inf norm |V_tpg8 - Vfine| = 1.23e-02  with # grid points: 526593
L_inf norm |V_sg1 - Vfine| = 2.93e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.43e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.57e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.23e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.45e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 5.95e-02  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 3.72e-02  with # grid points: 9345
L_inf norm |V_sg8 - Vfine| = 2.86e-02  with # grid points: 20737


Algorithm converged. Run-time of: 566.93 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0469, K = 5.61),  markets(S = -4.07e-18,  Y-C-I = -1.67e-13, Kgap = -1.72e-12) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.710095. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -6.96e-19,  Y-C-I = 2.79e-13, Kgap = 2.83e-12) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280048. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0491, K = 5.42),  markets(S = -8.54e-19,  Y-C-I = -4.58e-13, Kgap = -4.62e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118624. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = 7.32e-19,  Y-C-I = 4.01e-12, Kgap = 4.03e-11) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594423. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -1.12e-18,  Y-C-I = 1.02e-11, Kgap = 1.02e-10) 

Evaluating 605 points to refine on ...
Mean level of abs(aH): 0.0353737. Maximum level of grid: 9. 
Nodes coarsened: 53, children added: 413, parents added: 16, 
Net change: 1072 -> 1448 = << 376 >>, blacklisted: 84. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = 4.34e-19,  Y-C-I = 2.10e-11, Kgap = 2.10e-10) 

Evaluating 750 points to refine on ...
Mean level of abs(aH): 0.0262192. Maximum level of grid: 10. 
Nodes coarsened: 45, children added: 390, parents added: 95, 
Net change: 1448 -> 1888 = << 440 >>, blacklisted: 119. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.25e-18,  Y-C-I = 7.95e-11, Kgap = 7.97e-10) 

Evaluating 935 points to refine on ...
Mean level of abs(aH): 0.0201206. Maximum level of grid: 11. 
Nodes coarsened: 137, children added: 493, parents added: 188, 
Net change: 1888 -> 2432 = << 544 >>, blacklisted: 240. 


 -------  GRID ADAPTATION ITERATION 8  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.36e-18,  Y-C-I = 9.18e-11, Kgap = 9.20e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.93e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.45e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.42e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.76e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.77e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 8.32e-02  with # grid points: 33345
L_inf norm |V_tpg7 - Vfine| = 3.63e-02  with # grid points: 132225
L_inf norm |V_tpg8 - Vfine| = 1.26e-02  with # grid points: 526593
L_inf norm |V_sg1 - Vfine| = 2.93e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.42e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 7.00e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.24e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.43e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 4.35e-02  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 3.69e-02  with # grid points: 9345
L_inf norm |V_sg8 - Vfine| = 2.96e-02  with # grid points: 20737


Algorithm converged. Run-time of: 864.08 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0592, K = 4.69),  markets(S = 5.37e-18,  Y-C-I = 3.47e-01, Kgap = 1.42e-03) 

Evaluating 23 points to refine on ...
Mean level of abs(aH): 559.314. Maximum level of grid: 5. 
Nodes coarsened: 13, children added: 18, parents added: 1, 
Net change: 51 -> 57 = << 6 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0478, K = 5.53),  markets(S = -1.52e-18,  Y-C-I = -4.25e-11, Kgap = -4.35e-10) 

Evaluating 57 points to refine on ...
Mean level of abs(aH): 0.63761. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 76, parents added: 2, 
Net change: 57 -> 135 = << 78 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0486, K = 5.46),  markets(S = 8.13e-20,  Y-C-I = 2.58e-13, Kgap = 2.61e-12) 

Evaluating 133 points to refine on ...
Mean level of abs(aH): 0.273838. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 182, parents added: 4, 
Net change: 135 -> 321 = << 186 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.41),  markets(S = -2.44e-18,  Y-C-I = -3.53e-14, Kgap = -3.55e-13) 

Evaluating 279 points to refine on ...
Mean level of abs(aH): 0.116226. Maximum level of grid: 8. 
Nodes coarsened: 3, children added: 344, parents added: 8, 
Net change: 321 -> 670 = << 349 >>, blacklisted: 16. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -2.28e-18,  Y-C-I = 8.59e-13, Kgap = 8.64e-12) 

Evaluating 516 points to refine on ...
Mean level of abs(aH): 0.0560265. Maximum level of grid: 9. 
Nodes coarsened: 16, children added: 594, parents added: 12, 
Net change: 670 -> 1260 = << 590 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 85)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',85,0)">line 85</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 85)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',85,0)">line 85</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0592, K = 4.69),  markets(S = 5.37e-18,  Y-C-I = 3.47e-01, Kgap = 1.42e-03) 

Evaluating 23 points to refine on ...
Mean level of abs(aH): 559.314. Maximum level of grid: 5. 
Nodes coarsened: 13, children added: 18, parents added: 1, 
Net change: 51 -> 57 = << 6 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0478, K = 5.53),  markets(S = -1.52e-18,  Y-C-I = -4.25e-11, Kgap = -4.35e-10) 

Evaluating 57 points to refine on ...
Mean level of abs(aH): 0.63761. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 76, parents added: 2, 
Net change: 57 -> 135 = << 78 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0486, K = 5.46),  markets(S = 8.13e-20,  Y-C-I = 2.58e-13, Kgap = 2.61e-12) 

Evaluating 133 points to refine on ...
Mean level of abs(aH): 0.273838. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 182, parents added: 4, 
Net change: 135 -> 321 = << 186 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.41),  markets(S = -2.44e-18,  Y-C-I = -3.53e-14, Kgap = -3.55e-13) 

Evaluating 279 points to refine on ...
Mean level of abs(aH): 0.116226. Maximum level of grid: 8. 
Nodes coarsened: 3, children added: 344, parents added: 8, 
Net change: 321 -> 670 = << 349 >>, blacklisted: 16. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -2.28e-18,  Y-C-I = 8.59e-13, Kgap = 8.64e-12) 

Evaluating 516 points to refine on ...
Mean level of abs(aH): 0.0560265. Maximum level of grid: 9. 
Nodes coarsened: 16, children added: 594, parents added: 12, 
Net change: 670 -> 1260 = << 590 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -2.39e-18,  Y-C-I = 1.87e-11, Kgap = 1.88e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.91e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.42e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.08e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.42e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.43e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 4.93e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.91e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.39e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.66e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 2.88e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.07e-01  with # grid points: 1825
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.76e+06
{Unable to perform assignment because the size of the left side is 1-by-1 and the size of the right side is 1-by-4161.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sparseProject', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m', 10)" style="font-weight:bold">sparseProject</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m',10,0)">line 10</a>)
        xProject(i, :) = BH * xH;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 160)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',160,0)">line 160</a>)
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0592, K = 4.69),  markets(S = 5.26e-18,  Y-C-I = 3.47e-01, Kgap = 1.42e-03) 

Evaluating 23 points to refine on ...
Mean level of abs(aH): 559.32. Maximum level of grid: 5. 
Nodes coarsened: 13, children added: 18, parents added: 1, 
Net change: 51 -> 57 = << 6 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0478, K = 5.53),  markets(S = -1.26e-18,  Y-C-I = -7.04e-13, Kgap = -7.20e-12) 

Evaluating 57 points to refine on ...
Mean level of abs(aH): 0.640012. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 76, parents added: 2, 
Net change: 57 -> 135 = << 78 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0486, K = 5.46),  markets(S = -1.41e-18,  Y-C-I = -5.20e-10, Kgap = -5.27e-09) 

Evaluating 132 points to refine on ...
Mean level of abs(aH): 0.274737. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 180, parents added: 12, 
Net change: 135 -> 327 = << 192 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.41),  markets(S = -2.81e-18,  Y-C-I = -2.45e-13, Kgap = -2.47e-12) 

Evaluating 286 points to refine on ...
Mean level of abs(aH): 0.114591. Maximum level of grid: 8. 
Nodes coarsened: 2, children added: 362, parents added: 8, 
Net change: 327 -> 695 = << 368 >>, blacklisted: 15. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -2.28e-18,  Y-C-I = 2.90e-12, Kgap = 2.91e-11) 

Evaluating 535 points to refine on ...
Mean level of abs(aH): 0.0542592. Maximum level of grid: 9. 
Nodes coarsened: 17, children added: 618, parents added: 14, 
Net change: 695 -> 1310 = << 615 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -2.17e-18,  Y-C-I = 1.00e-11, Kgap = 1.00e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.91e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.42e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.08e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.42e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.43e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 4.93e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.91e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.39e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.66e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 2.88e-01  with # grid points: 785
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.76e+03
{Unable to perform assignment because the size of the left side is 1-by-1 and the size of the right side is 1-by-1825.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sparseProject', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m', 10)" style="font-weight:bold">sparseProject</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m',10,0)">line 10</a>)
        xProject(i, :) = BH * xH;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 160)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',160,0)">line 160</a>)
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0592, K = 4.69),  markets(S = 5.26e-18,  Y-C-I = 3.47e-01, Kgap = 1.42e-03) 

Evaluating 23 points to refine on ...
Mean level of abs(aH): 559.32. Maximum level of grid: 5. 
Nodes coarsened: 13, children added: 18, parents added: 1, 
Net change: 51 -> 57 = << 6 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0478, K = 5.53),  markets(S = -1.26e-18,  Y-C-I = -7.04e-13, Kgap = -7.20e-12) 

Evaluating 57 points to refine on ...
Mean level of abs(aH): 0.640012. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 76, parents added: 2, 
Net change: 57 -> 135 = << 78 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0486, K = 5.46),  markets(S = -1.41e-18,  Y-C-I = -5.20e-10, Kgap = -5.27e-09) 

Evaluating 132 points to refine on ...
Mean level of abs(aH): 0.274737. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 180, parents added: 12, 
Net change: 135 -> 327 = << 192 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.41),  markets(S = -2.20e-18,  Y-C-I = -4.26e-14, Kgap = -4.32e-13) 

Evaluating 287 points to refine on ...
Mean level of abs(aH): 0.114598. Maximum level of grid: 8. 
Nodes coarsened: 1, children added: 362, parents added: 7, 
Net change: 327 -> 695 = << 368 >>, blacklisted: 14. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -3.55e-18,  Y-C-I = 2.15e-12, Kgap = 2.16e-11) 

Evaluating 529 points to refine on ...
Mean level of abs(aH): 0.0542108. Maximum level of grid: 9. 
Nodes coarsened: 15, children added: 598, parents added: 5, 
Net change: 695 -> 1283 = << 588 >>, blacklisted: 29. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -1.19e-18,  Y-C-I = 2.68e-11, Kgap = 2.68e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.91e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.42e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 7.08e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 3.42e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.43e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 4.93e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.91e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.39e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 6.66e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 2.88e-01  with # grid points: 785
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 6.84e+03
{Unable to perform assignment because the size of the left side is 1-by-1 and the size of the right side is 1-by-1825.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sparseProject', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m', 10)" style="font-weight:bold">sparseProject</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m',10,0)">line 10</a>)
        xProject(i, :) = BH * xH;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 160)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',160,0)">line 160</a>)
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0679, K = 4.18),  markets(S = -5.42e-18,  Y-C-I = 3.33e-01, Kgap = -2.92e-03) 

Evaluating 13 points to refine on ...
Mean level of abs(aH): 2566.13. Maximum level of grid: 5. 
Nodes coarsened: 28, children added: 12, parents added: 0, 
Net change: 51 -> 35 = << -16 >>, blacklisted: 28. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0470, K = 5.59),  markets(S = -1.31e-18,  Y-C-I = 5.02e-13, Kgap = 5.17e-12) 

Evaluating 35 points to refine on ...
Mean level of abs(aH): 1.03528. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 44, parents added: 3, 
Net change: 35 -> 82 = << 47 >>, blacklisted: 28. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0483, K = 5.49),  markets(S = 1.08e-19,  Y-C-I = -2.53e-12, Kgap = -2.57e-11) 

Evaluating 82 points to refine on ...
Mean level of abs(aH): 0.456014. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 108, parents added: 10, 
Net change: 82 -> 200 = << 118 >>, blacklisted: 28. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0489, K = 5.43),  markets(S = -6.51e-19,  Y-C-I = -2.06e-11, Kgap = -2.08e-10) 

Evaluating 185 points to refine on ...
Mean level of abs(aH): 0.190807. Maximum level of grid: 8. 
Nodes coarsened: 1, children added: 232, parents added: 6, 
Net change: 200 -> 437 = << 237 >>, blacklisted: 29. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0493, K = 5.40),  markets(S = -2.60e-18,  Y-C-I = 7.26e-12, Kgap = 7.30e-11) 

Evaluating 364 points to refine on ...
Mean level of abs(aH): 0.0882142. Maximum level of grid: 9. 
Nodes coarsened: 3, children added: 444, parents added: 22, 
Net change: 437 -> 900 = << 463 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0496, K = 5.38),  markets(S = -1.73e-18,  Y-C-I = -2.74e-12, Kgap = -2.75e-11) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_FD_interior', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD_interior.m', 25)" style="font-weight:bold">gen_FD_interior</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD_interior.m',25,0)">line 25</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_derived_fields', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m', 23)" style="font-weight:bold">gen_derived_fields</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m',23,0)">line 23</a>)
    G = gen_FD_interior(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('setup_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m', 51)" style="font-weight:bold">setup_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m',51,0)">line 51</a>)
G = gen_derived_fields(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 117)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',117,0)">line 117</a>)
GFine = setup_grid(0, param.surplusFine, param.min, param.max, 'named_dims', {1,2}, 'names', {'k','z'}, 'dxx_dims', 2);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0451, K = 5.76),  markets(S = -4.12e-18,  Y-C-I = -5.11e-10, Kgap = -5.37e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.706106. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0478, K = 5.53),  markets(S = -1.27e-18,  Y-C-I = -4.35e-12, Kgap = -4.45e-11) 

Evaluating 124 points to refine on ...
Mean level of abs(aH): 0.286685. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 178, parents added: 0, 
Net change: 133 -> 311 = << 178 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0487, K = 5.45),  markets(S = -2.35e-19,  Y-C-I = -7.81e-14, Kgap = -7.93e-13) 

Evaluating 256 points to refine on ...
Mean level of abs(aH): 0.124726. Maximum level of grid: 7. 
Nodes coarsened: 9, children added: 321, parents added: 5, 
Net change: 311 -> 628 = << 317 >>, blacklisted: 9. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0493, K = 5.41),  markets(S = -9.28e-19,  Y-C-I = -4.76e-12, Kgap = -4.79e-11) 

Evaluating 417 points to refine on ...
Mean level of abs(aH): 0.0626412. Maximum level of grid: 8. 
Nodes coarsened: 29, children added: 407, parents added: 20, 
Net change: 628 -> 1026 = << 398 >>, blacklisted: 33. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0496, K = 5.38),  markets(S = -1.00e-18,  Y-C-I = -6.39e-12, Kgap = -6.42e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0385995. Maximum level of grid: 9. 
Nodes coarsened: 47, children added: 485, parents added: 54, 
Net change: 1026 -> 1518 = << 492 >>, blacklisted: 75. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.60e-18,  Y-C-I = -3.78e-11, Kgap = -3.79e-10) 

L_inf norm |V_tpg1 - Vfine| = 3.06e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.53e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 8.03e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 4.00e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.70e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 5.91e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 3.06e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.50e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 7.35e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.21e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.18e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 1.01e-01  with # grid points: 4161


Algorithm converged. Run-time of: 63.67 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0653, K = 4.32),  markets(S = 1.63e-19,  Y-C-I = 3.38e-01, Kgap = 3.92e-03) 

Evaluating 15 points to refine on ...
Mean level of abs(aH): 1647.73. Maximum level of grid: 5. 
Nodes coarsened: 24, children added: 13, parents added: 0, 
Net change: 51 -> 40 = << -11 >>, blacklisted: 24. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0648, K = 4.35),  markets(S = -1.29e-17,  Y-C-I = -1.12e+00, Kgap = -1.23e+01) 

Evaluating 40 points to refine on ...
Mean level of abs(aH): 5.35968. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 51, parents added: 2, 
Net change: 40 -> 93 = << 53 >>, blacklisted: 24. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.1079, K = 2.71),  markets(S = -8.67e-19,  Y-C-I = 8.18e-01, Kgap = 7.99e-03) 

Evaluating 88 points to refine on ...
Mean level of abs(aH): 20.2281. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 116, parents added: 12, 
Net change: 93 -> 221 = << 128 >>, blacklisted: 24. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 300)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',300,0)">line 300</a>)
Objective function is returning undefined values at initial point. FSOLVE cannot continue.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 85)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',85,0)">line 85</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0451, K = 5.76),  markets(S = -4.12e-18,  Y-C-I = -5.11e-10, Kgap = -5.37e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.706106. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0478, K = 5.53),  markets(S = -1.27e-18,  Y-C-I = -4.35e-12, Kgap = -4.45e-11) 

Evaluating 124 points to refine on ...
Mean level of abs(aH): 0.286685. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 178, parents added: 0, 
Net change: 133 -> 311 = << 178 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0487, K = 5.45),  markets(S = -2.35e-19,  Y-C-I = -7.81e-14, Kgap = -7.93e-13) 

Evaluating 256 points to refine on ...
Mean level of abs(aH): 0.124726. Maximum level of grid: 7. 
Nodes coarsened: 9, children added: 321, parents added: 5, 
Net change: 311 -> 628 = << 317 >>, blacklisted: 9. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0493, K = 5.41),  markets(S = -9.28e-19,  Y-C-I = -4.76e-12, Kgap = -4.79e-11) 

Evaluating 417 points to refine on ...
Mean level of abs(aH): 0.0626412. Maximum level of grid: 8. 
Nodes coarsened: 29, children added: 407, parents added: 20, 
Net change: 628 -> 1026 = << 398 >>, blacklisted: 33. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0496, K = 5.38),  markets(S = -1.00e-18,  Y-C-I = -6.39e-12, Kgap = -6.42e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0385995. Maximum level of grid: 9. 
Nodes coarsened: 47, children added: 485, parents added: 54, 
Net change: 1026 -> 1518 = << 492 >>, blacklisted: 75. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.60e-18,  Y-C-I = -3.78e-11, Kgap = -3.79e-10) 

Evaluating 790 points to refine on ...
Mean level of abs(aH): 0.026181. Maximum level of grid: 10. 
Nodes coarsened: 46, children added: 486, parents added: 74, 
Net change: 1518 -> 2032 = << 514 >>, blacklisted: 119. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.72e-18,  Y-C-I = 3.65e-11, Kgap = 3.66e-10) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('unique>uniqueR2012a', '/Applications/MATLAB_R2021a.app/toolbox/matlab/ops/unique.m', 175)" style="font-weight:bold">unique>uniqueR2012a</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/matlab/ops/unique.m',175,0)">line 175</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('unique', '/Applications/MATLAB_R2021a.app/toolbox/matlab/ops/unique.m', 161)" style="font-weight:bold">unique</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/matlab/ops/unique.m',161,0)">line 161</a>)
        [varargout{1:nlhs}] = uniqueR2012a(varargin{1},logical(flaginds(1:5)));

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_bound_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_bound_grid.m', 13)" style="font-weight:bold">gen_bound_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_bound_grid.m',13,0)">line 13</a>)
    [boundGrid, IA, IC] = unique(boundGrid, 'rows');

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_derived_fields', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m', 22)" style="font-weight:bold">gen_derived_fields</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m',22,0)">line 22</a>)
    G = gen_bound_grid(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('setup_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m', 51)" style="font-weight:bold">setup_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m',51,0)">line 51</a>)
G = gen_derived_fields(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 117)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',117,0)">line 117</a>)
GFine = setup_grid(0, param.surplusFine, param.min, param.max, 'named_dims', {1,2}, 'names', {'k','z'}, 'dxx_dims', 2);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0650, K = 4.34),  markets(S = 5.18e-18,  Y-C-I = 3.38e-01, Kgap = 2.68e-03) 

Evaluating 15 points to refine on ...
Mean level of abs(aH): 1449.54. Maximum level of grid: 5. 
Nodes coarsened: 22, children added: 13, parents added: 0, 
Net change: 51 -> 42 = << -9 >>, blacklisted: 22. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0646, K = 4.36),  markets(S = -7.54e-17,  Y-C-I = -1.09e+00, Kgap = -1.21e+01) 

Evaluating 42 points to refine on ...
Mean level of abs(aH): 5.11724. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 54, parents added: 1, 
Net change: 42 -> 97 = << 55 >>, blacklisted: 22. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.1009, K = 2.89),  markets(S = 8.67e-19,  Y-C-I = 8.12e-01, Kgap = -2.87e-05) 

Evaluating 96 points to refine on ...
Mean level of abs(aH): 20.0222. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 129, parents added: 7, 
Net change: 97 -> 233 = << 136 >>, blacklisted: 22. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 9.80e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 85)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',85,0)">line 85</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In finDiffEvalAndChkErr

In finitedifferences

In computeFinDiffGradAndJac

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 255)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',255,0)">line 255</a>)
        [JAC,~,~,numFDfevals,evalOK] = computeFinDiffGradAndJac(x,funfcn,confcn,Fvec, ...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 85)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',85,0)">line 85</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0648, K = 4.35),  markets(S = 2.86e-18,  Y-C-I = 3.39e-01, Kgap = 3.76e-03) 

Evaluating 16 points to refine on ...
Mean level of abs(aH): 1226.92. Maximum level of grid: 5. 
Nodes coarsened: 21, children added: 14, parents added: 0, 
Net change: 51 -> 44 = << -7 >>, blacklisted: 21. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0642, K = 4.38),  markets(S = -6.26e-17,  Y-C-I = -1.01e+00, Kgap = -1.14e+01) 

Evaluating 44 points to refine on ...
Mean level of abs(aH): 4.87267. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 56, parents added: 1, 
Net change: 44 -> 101 = << 57 >>, blacklisted: 21. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.1062, K = 2.75),  markets(S = -8.67e-19,  Y-C-I = 7.92e-01, Kgap = -1.50e-04) 

Evaluating 97 points to refine on ...
Mean level of abs(aH): 17.8614. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 128, parents added: 11, 
Net change: 101 -> 239 = << 138 >>, blacklisted: 22. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 6.06e+00
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.12e+02
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('FDoperator', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/FDoperator.m', 53)" style="font-weight:bold">FDoperator</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/FDoperator.m',53,0)">line 53</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 6)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',6,0)">line 6</a>)
[Az, const_z] = FDoperator(G, param.theta_z * (param.zmean - G.z), param.sig_z*ones(G.J,1), 2);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 85)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',85,0)">line 85</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 85)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',85,0)">line 85</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0637, K = 4.42),  markets(S = 7.70e-18,  Y-C-I = 3.40e-01, Kgap = 2.82e-03) 

Evaluating 20 points to refine on ...
Mean level of abs(aH): 871.567. Maximum level of grid: 5. 
Nodes coarsened: 14, children added: 16, parents added: 0, 
Net change: 51 -> 53 = << 2 >>, blacklisted: 14. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0597, K = 4.66),  markets(S = -2.06e-18,  Y-C-I = 6.12e-02, Kgap = -2.18e+00) 

Evaluating 53 points to refine on ...
Mean level of abs(aH): 4.13709. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 70, parents added: 2, 
Net change: 53 -> 125 = << 72 >>, blacklisted: 14. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0597, K = 4.66),  markets(S = -1.29e-17,  Y-C-I = 1.68e-01, Kgap = -1.29e+00) 

Evaluating 122 points to refine on ...
Mean level of abs(aH): 2.58406. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 163, parents added: 9, 
Net change: 125 -> 297 = << 172 >>, blacklisted: 14. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0614, K = 4.55),  markets(S = -4.32e-18,  Y-C-I = 3.07e-01, Kgap = -2.53e-04) 

Evaluating 280 points to refine on ...
Mean level of abs(aH): 1.35076. Maximum level of grid: 8. 
Nodes coarsened: 6, children added: 360, parents added: 21, 
Net change: 297 -> 672 = << 375 >>, blacklisted: 20. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.30e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 85)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',85,0)">line 85</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In finDiffEvalAndChkErr

In finitedifferences

In computeFinDiffGradAndJac

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 124)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',124,0)">line 124</a>)
    [JAC,~,~,numFDfevals,evalOK] = computeFinDiffGradAndJac(x,funfcn,confcn,Fvec, ...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 85)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',85,0)">line 85</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0637, K = 4.42),  markets(S = 2.63e-18,  Y-C-I = 3.40e-01, Kgap = 2.82e-03) 

Evaluating 20 points to refine on ...
Mean level of abs(aH): 871.567. Maximum level of grid: 5. 
Nodes coarsened: 14, children added: 16, parents added: 0, 
Net change: 51 -> 53 = << 2 >>, blacklisted: 14. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0632, K = 4.44),  markets(S = -1.25e-16,  Y-C-I = -1.23e+00, Kgap = -1.35e+01) 

Evaluating 53 points to refine on ...
Mean level of abs(aH): 4.17856. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 70, parents added: 2, 
Net change: 53 -> 125 = << 72 >>, blacklisted: 14. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.57e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.57e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.57e+02
Stationary Equilibrium: (r = 0.1070, K = 2.73),  markets(S = 3.47e-18,  Y-C-I = 7.90e-01, Kgap = -4.79e-05) 

Evaluating 111 points to refine on ...
Mean level of abs(aH): 14.6027. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 145, parents added: 13, 
Net change: 125 -> 281 = << 156 >>, blacklisted: 16. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 85)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',85,0)">line 85</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In finDiffEvalAndChkErr

In finitedifferences

In computeFinDiffGradAndJac

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 255)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',255,0)">line 255</a>)
        [JAC,~,~,numFDfevals,evalOK] = computeFinDiffGradAndJac(x,funfcn,confcn,Fvec, ...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 85)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',85,0)">line 85</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0451, K = 5.76),  markets(S = -4.12e-18,  Y-C-I = -5.11e-10, Kgap = -5.37e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.706106. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0478, K = 5.53),  markets(S = -1.27e-18,  Y-C-I = -4.35e-12, Kgap = -4.45e-11) 

Evaluating 124 points to refine on ...
Mean level of abs(aH): 0.286685. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 178, parents added: 0, 
Net change: 133 -> 311 = << 178 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0487, K = 5.45),  markets(S = -2.35e-19,  Y-C-I = -7.81e-14, Kgap = -7.93e-13) 

Evaluating 256 points to refine on ...
Mean level of abs(aH): 0.124726. Maximum level of grid: 7. 
Nodes coarsened: 9, children added: 321, parents added: 5, 
Net change: 311 -> 628 = << 317 >>, blacklisted: 9. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0493, K = 5.41),  markets(S = -9.28e-19,  Y-C-I = -4.76e-12, Kgap = -4.79e-11) 

Evaluating 417 points to refine on ...
Mean level of abs(aH): 0.0626412. Maximum level of grid: 8. 
Nodes coarsened: 29, children added: 407, parents added: 20, 
Net change: 628 -> 1026 = << 398 >>, blacklisted: 33. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0496, K = 5.38),  markets(S = -1.00e-18,  Y-C-I = -6.39e-12, Kgap = -6.42e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0385995. Maximum level of grid: 9. 
Nodes coarsened: 47, children added: 485, parents added: 54, 
Net change: 1026 -> 1518 = << 492 >>, blacklisted: 75. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.60e-18,  Y-C-I = -3.78e-11, Kgap = -3.79e-10) 

Evaluating 790 points to refine on ...
Mean level of abs(aH): 0.026181. Maximum level of grid: 10. 
Nodes coarsened: 46, children added: 486, parents added: 74, 
Net change: 1518 -> 2032 = << 514 >>, blacklisted: 119. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.72e-18,  Y-C-I = 3.65e-11, Kgap = 3.66e-10) 

L_inf norm |V_tpg1 - Vfine| = 3.08e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.56e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 8.31e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 4.28e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 1.98e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 8.70e-02  with # grid points: 33345
L_inf norm |V_tpg7 - Vfine| = 2.91e-02  with # grid points: 132225
L_inf norm |V_sg1 - Vfine| = 3.08e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.52e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 7.63e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.50e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.46e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 8.32e-02  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 7.23e-02  with # grid points: 9345


Algorithm converged. Run-time of: 227.42 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0451, K = 5.76),  markets(S = -4.12e-18,  Y-C-I = -5.11e-10, Kgap = -5.37e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.706106. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0478, K = 5.53),  markets(S = -1.27e-18,  Y-C-I = -4.35e-12, Kgap = -4.45e-11) 

Evaluating 124 points to refine on ...
Mean level of abs(aH): 0.286685. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 178, parents added: 0, 
Net change: 133 -> 311 = << 178 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0487, K = 5.45),  markets(S = -2.35e-19,  Y-C-I = -7.81e-14, Kgap = -7.93e-13) 

Evaluating 256 points to refine on ...
Mean level of abs(aH): 0.124726. Maximum level of grid: 7. 
Nodes coarsened: 9, children added: 321, parents added: 5, 
Net change: 311 -> 628 = << 317 >>, blacklisted: 9. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0493, K = 5.41),  markets(S = -9.28e-19,  Y-C-I = -4.76e-12, Kgap = -4.79e-11) 

Evaluating 417 points to refine on ...
Mean level of abs(aH): 0.0626412. Maximum level of grid: 8. 
Nodes coarsened: 29, children added: 407, parents added: 20, 
Net change: 628 -> 1026 = << 398 >>, blacklisted: 33. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0496, K = 5.38),  markets(S = -1.00e-18,  Y-C-I = -6.39e-12, Kgap = -6.42e-11) 

Evaluating 604 points to refine on ...
Mean level of abs(aH): 0.0385995. Maximum level of grid: 9. 
Nodes coarsened: 47, children added: 485, parents added: 54, 
Net change: 1026 -> 1518 = << 492 >>, blacklisted: 75. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.37),  markets(S = -3.60e-18,  Y-C-I = -3.78e-11, Kgap = -3.79e-10) 

Evaluating 790 points to refine on ...
Mean level of abs(aH): 0.026181. Maximum level of grid: 10. 
Nodes coarsened: 46, children added: 486, parents added: 74, 
Net change: 1518 -> 2032 = << 514 >>, blacklisted: 119. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -2.72e-18,  Y-C-I = 3.65e-11, Kgap = 3.66e-10) 

Evaluating 977 points to refine on ...
Mean level of abs(aH): 0.019592. Maximum level of grid: 11. 
Nodes coarsened: 152, children added: 495, parents added: 196, 
Net change: 2032 -> 2571 = << 539 >>, blacklisted: 266. 


 -------  GRID ADAPTATION ITERATION 8  ------- 

Stationary Equilibrium: (r = 0.0498, K = 5.36),  markets(S = -1.67e-18,  Y-C-I = -1.29e-10, Kgap = -1.29e-09) 

L_inf norm |V_tpg1 - Vfine| = 3.12e+00  with # grid points: 51
L_inf norm |V_tpg2 - Vfine| = 1.62e+00  with # grid points: 165
L_inf norm |V_tpg3 - Vfine| = 8.59e-01  with # grid points: 585
L_inf norm |V_tpg4 - Vfine| = 4.35e-01  with # grid points: 2193
L_inf norm |V_tpg5 - Vfine| = 2.04e-01  with # grid points: 8481
L_inf norm |V_tpg6 - Vfine| = 9.95e-02  with # grid points: 33345
L_inf norm |V_tpg7 - Vfine| = 4.58e-02  with # grid points: 132225
L_inf norm |V_tpg8 - Vfine| = 1.57e-02  with # grid points: 526593
L_inf norm |V_sg1 - Vfine| = 3.12e+00  with # grid points: 51
L_inf norm |V_sg2 - Vfine| = 1.58e+00  with # grid points: 133
L_inf norm |V_sg3 - Vfine| = 7.57e-01  with # grid points: 329
L_inf norm |V_sg4 - Vfine| = 3.59e-01  with # grid points: 785
L_inf norm |V_sg5 - Vfine| = 1.50e-01  with # grid points: 1825
L_inf norm |V_sg6 - Vfine| = 7.29e-02  with # grid points: 4161
L_inf norm |V_sg7 - Vfine| = 6.16e-02  with # grid points: 9345
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 3.65e+06
{Unable to perform assignment because the size of the left side is 1-by-1 and the size of the right side is 1-by-20737.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sparseProject', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m', 10)" style="font-weight:bold">sparseProject</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m',10,0)">line 10</a>)
        xProject(i, :) = BH * xH;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 160)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',160,0)">line 160</a>)
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
} 
opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',160,0)
% Adaptive sparse grids:
for j = 1:adaptIter
    
    [~,~,~,ssASG{j}] = stationary([ss.K, ss.tau], G_adapt{j}, GDense, param);

    Vtest = zeros(P,1);
    for k = 1:P
        Vtest(k) = sparseProject(ssASG{j}.V, points(k,:), G_adapt{j});
    end
    G_adapt{j}.Vtest = Vtest;
    G_adapt{j}.normInf = norm(G_adapt{j}.Vtest - GFine.Vtest, Inf);
    
end
% Plot:
normASG=[];normSG=[];normTPG=[]; gridPointsASG=[];gridPointsSG=[];gridPointsTPG=[];
for j = 1:max([numel(G_adapt),numel(GSG),numel(GTPG)]) %param.fineLevel-1
    if j>numel(G_adapt)
        continue;
    else
        normASG(j) = G_adapt{j}.normInf;
        gridPointsASG(j) = G_adapt{j}.J;
    end
    
    if j>numel(GSG)
        continue;
    else
        normSG(j)  = GSG{j}.normInf;
        gridPointsSG(j)  = GSG{j}.J;
    end
    
    if j>numel(GTPG)
        continue;
    else
        normTPG(j) = GTPG{j}.normInf;
        gridPointsTPG(j) = GTPG{j}.J;
    end    
end
{Unrecognized field name "normInf".
} 
j

j =

     8

runTime = toc(runTime); fprintf('\n\nAlgorithm converged. Run-time of: %.2f seconds.\n',runTime);


Algorithm converged. Run-time of: 1480.48 seconds.

fprintf('\nPlotting Figures...\n');

Plotting Figures...
for n = 1:adaptIter
    
    figure('visible', 'off');
    subplot(1,2,1);
    l1=scatter3(G_adapt{n}.k, G_adapt{n}.z, V_adapt{n});
    xlabel('Capital: $k$','Interpreter','Latex');
        xlh = get(gca,'xlabel'); gxl = get(xlh); xlp = get(xlh, 'Position');
        set(xlh,'Rotation', 16,'Position',xlp,'VerticalAlignment','middle','HorizontalAlignment','left');
    ylabel('Earnings: $z$','Interpreter','Latex');
        ylh = get(gca,'ylabel'); gyl = get(ylh); ylp = get(ylh, 'Position');
        set(ylh,'Rotation',-27,'Position',ylp,'VerticalAlignment','middle','HorizontalAlignment','right');
    title('$V(a,z)$','Interpreter','Latex');
        
    subplot(1,2,2);
    l1=scatter3(G_adapt{n}.k, G_adapt{n}.z, c_adapt{n});
    xlabel('Capital: $k$','Interpreter','Latex');
        xlh = get(gca,'xlabel'); gxl = get(xlh); xlp = get(xlh, 'Position');
        set(xlh,'Rotation', 16,'Position',xlp,'VerticalAlignment','middle','HorizontalAlignment','left');
    ylabel('Earnings: $z$','Interpreter','Latex');
        ylh = get(gca,'ylabel'); gyl = get(ylh); ylp = get(ylh, 'Position');
        set(ylh,'Rotation',-27,'Position',ylp,'VerticalAlignment','middle','HorizontalAlignment','right');
    title('$c(a,z)$','Interpreter','Latex');
    
    set(gcf,'renderer','Painters', 'Position', [10 10 1200 400]);
    exportgraphics(gcf, ['./output/grid_adaptation', num2str(n-1), '.eps']);

end

figure('visible', 'off');
subplot(1,2,1); hold on;
l1 = plot(1:numel(normASG), normASG);
l2 = plot(1:numel(normSG), normSG);
l3 = plot(1:numel(normTPG), normTPG);
hold off; title('$L_\infty$ norm','Interpreter','Latex');
xlabel('Grid levels / adaptations');
legend([l1,l2,l3],{'Adaptive Sparse Grid', 'Regular Sparse Grid', 'Uniform Dense Grid'}, 'box', 'off');

subplot(1,2,2); hold on;
l1 = plot(1:numel(gridPointsASG), gridPointsASG);
l2 = plot(1:numel(gridPointsSG), gridPointsSG);
l3 = plot(1:numel(gridPointsTPG), gridPointsTPG);
hold off; title('Grid points','Interpreter','Latex');
xlabel('Grid levels / adaptations');
    
set(gcf,'renderer','Painters');
exportgraphics(gcf, './output/error1.eps');


figure('visible', 'off'); hold on;
l1 = plot(gridPointsASG, normASG); 
l2 = plot(gridPointsSG,  normSG);
l3 = plot(gridPointsTPG, normTPG);
hold off;
xlabel('Grid points'); 
title('$L_\infty$ norm','Interpreter','Latex');
set(gca, 'XScale','log', 'YScale','log');
    
legend([l1,l2,l3],{'Adaptive Sparse Grid', 'Regular Sparse Grid', 'Uniform Dense Grid'}, 'box', 'off');
set(gcf,'renderer','Painters');
exportgraphics(gcf, './output/error2.eps');

diary off
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_FD', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD.m', 46)" style="font-weight:bold">gen_FD</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD.m',46,0)">line 46</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 27)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',27,0)">line 27</a>)
GDense = gen_FD(GDense, BC);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Complex values in VFI: terminating process.Complex values in VFI: terminating process.Complex values in VFI: terminating process.Complex values in VFI: terminating process.Stationary Equilibrium: (r = -27786.7731, K = -0.00),  markets(S = 00,  Y-C-I = 4.07e-04, Kgap = -1.46e-08) 

Evaluating 0 points to refine on ...
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('mpower', '/Applications/MATLAB_R2021a.app/toolbox/matlab/ops/mpower.m', 51)" style="font-weight:bold"> ^ </a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/matlab/ops/mpower.m',51,0)">line 51</a>)
Incorrect dimensions for raising a matrix to a power. Check that the matrix is square and the power is a scalar. To perform elementwise
matrix powers, use '.^'.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('add_parents>find_parents', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m', 63)" style="font-weight:bold">add_parents>find_parents</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m',63,0)">line 63</a>)
    nmax = 2^maxl;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('add_parents', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m', 4)" style="font-weight:bold">add_parents</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m',4,0)">line 4</a>)
    [parentMat, fullGridVec, lVec] = find_parents(maxl);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('adapt_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/adapt_grid.m', 110)" style="font-weight:bold">adapt_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/adapt_grid.m',110,0)">line 110</a>)
    [parents, parentLevels] = add_parents(gridNew, lvlNew);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 102)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',102,0)">line 102</a>)
    [G, BH_adapt, blacklist, stats] = adapt_grid(G, ss.V, blacklist, ...
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 5.22e-08
Stationary Equilibrium: (r = 0.0384, K = 6.43),  markets(S = -2.89e-18,  Y-C-I = 3.95e-01, Kgap = 1.13e-01) 

Evaluating 12 points to refine on ...
Mean level of abs(aH): 1.90173e+07. Maximum level of grid: 5. 
Nodes coarsened: 39, children added: 14, parents added: 5, 
Net change: 51 -> 31 = << -20 >>, blacklisted: 39. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 3.13e-06
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.53e-07
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.29e-07
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 7.63e-08
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.38e-07
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 4.10e-08
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.38e-07
Stationary Equilibrium: (r = 0.0384, K = 6.43),  markets(S = -6.94e-18,  Y-C-I = 7.00e-01, Kgap = 3.57e+00) 

Evaluating 28 points to refine on ...
Mean level of abs(aH): 5.79299e+07. Maximum level of grid: 6. 
Nodes coarsened: 3, children added: 36, parents added: 12, 
Net change: 31 -> 76 = << 45 >>, blacklisted: 42. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.95e+09
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: NaN
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('FDoperator', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/FDoperator.m', 37)" style="font-weight:bold">FDoperator</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/FDoperator.m',37,0)">line 37</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 15)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',15,0)">line 15</a>)
[Ak, const_k] = FDoperator(G, hjb.s, zeros(G.J,1), 1);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0629, K = 4.46),  markets(S = 2.70e-18,  Y-C-I = 3.41e-01, Kgap = 2.82e-03) 

Evaluating 23 points to refine on ...
Mean level of abs(aH): 584.711. Maximum level of grid: 5. 
Nodes coarsened: 12, children added: 24, parents added: 0, 
Net change: 51 -> 63 = << 12 >>, blacklisted: 12. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0572, K = 4.82),  markets(S = 8.37e-11,  Y-C-I = 1.92e-01, Kgap = -1.07e+00) 

Evaluating 63 points to refine on ...
Mean level of abs(aH): 3.71728. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 63 -> 145 = << 82 >>, blacklisted: 12. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0600, K = 4.64),  markets(S = -1.48e-17,  Y-C-I = 3.06e-01, Kgap = -2.37e-04) 

Evaluating 144 points to refine on ...
Mean level of abs(aH): 2.05631. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 198, parents added: 12, 
Net change: 145 -> 355 = << 210 >>, blacklisted: 12. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 83)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',83,0)">line 83</a>)
    [DIFF0,G,GDense,~] = stationary(X0, G, GDense, param);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0629, K = 4.46),  markets(S = 2.70e-18,  Y-C-I = 3.41e-01, Kgap = 2.82e-03) 

Evaluating 23 points to refine on ...
Mean level of abs(aH): 584.711. Maximum level of grid: 5. 
Nodes coarsened: 12, children added: 24, parents added: 0, 
Net change: 51 -> 63 = << 12 >>, blacklisted: 12. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0572, K = 4.82),  markets(S = 8.37e-11,  Y-C-I = 1.92e-01, Kgap = -1.07e+00) 

Evaluating 63 points to refine on ...
Mean level of abs(aH): 3.71728. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 63 -> 145 = << 82 >>, blacklisted: 12. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0600, K = 4.64),  markets(S = -1.48e-17,  Y-C-I = 3.06e-01, Kgap = -2.37e-04) 

Evaluating 144 points to refine on ...
Mean level of abs(aH): 2.05631. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 198, parents added: 12, 
Net change: 145 -> 355 = << 210 >>, blacklisted: 12. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 6.47e+01
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 7.22e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 6.61e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 7.25e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.21e+02
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 88)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',88,0)">line 88</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 88)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',88,0)">line 88</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0468, K = 5.61),  markets(S = -5.15e-18,  Y-C-I = -1.98e-10, Kgap = -2.05e-09) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.709794. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0485, K = 5.47),  markets(S = -1.65e-18,  Y-C-I = 1.22e-15, Kgap = 1.24e-14) 

Evaluating 127 points to refine on ...
Mean level of abs(aH): 0.280083. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 184, parents added: 0, 
Net change: 133 -> 317 = << 184 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0492, K = 5.42),  markets(S = -2.28e-18,  Y-C-I = 1.75e-13, Kgap = 1.76e-12) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.118633. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 318, parents added: 3, 
Net change: 317 -> 636 = << 319 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0495, K = 5.39),  markets(S = -1.71e-18,  Y-C-I = -1.49e-10, Kgap = -1.50e-09) 

Evaluating 438 points to refine on ...
Mean level of abs(aH): 0.0594499. Maximum level of grid: 8. 
Nodes coarsened: 30, children added: 451, parents added: 15, 
Net change: 636 -> 1072 = << 436 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0497, K = 5.37),  markets(S = -3.55e-18,  Y-C-I = -3.10e-12, Kgap = -3.11e-11) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_H_mat', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_H_mat.m', 45)" style="font-weight:bold">gen_H_mat</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_H_mat.m',45,0)">line 45</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_bound_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_bound_grid.m', 34)" style="font-weight:bold">gen_bound_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_bound_grid.m',34,0)">line 34</a>)
    gen_H_mat(boundGridAll, boundLvlAll);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_derived_fields', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m', 22)" style="font-weight:bold">gen_derived_fields</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m',22,0)">line 22</a>)
    G = gen_bound_grid(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('setup_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m', 51)" style="font-weight:bold">setup_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m',51,0)">line 51</a>)
G = gen_derived_fields(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 120)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',120,0)">line 120</a>)
GFine = setup_grid(0, param.surplusFine, param.min, param.max, 'named_dims', {1,2}, 'names', {'k','z'}, 'dxx_dims', 2);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0337, K = 6.98),  markets(S = -7.12e-18,  Y-C-I = 5.45e-01, Kgap = -3.48e-04) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 2.35945. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0289, K = 7.62),  markets(S = 3.08e-19,  Y-C-I = 5.74e-01, Kgap = -2.54e-04) 

Evaluating 130 points to refine on ...
Mean level of abs(aH): 0.928217. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 192, parents added: 0, 
Net change: 133 -> 325 = << 192 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0380, K = 6.48),  markets(S = -8.73e-19,  Y-C-I = -8.59e-12, Kgap = -9.76e-11) 

Evaluating 50 points to refine on ...
Mean level of abs(aH): 0.776729. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 79, parents added: 0, 
Net change: 51 -> 130 = << 79 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0390, K = 6.36),  markets(S = -4.49e-18,  Y-C-I = 1.19e-12, Kgap = 1.34e-11) 

Evaluating 125 points to refine on ...
Mean level of abs(aH): 0.310963. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 181, parents added: 0, 
Net change: 130 -> 311 = << 181 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0394, K = 6.32),  markets(S = -3.62e-18,  Y-C-I = -1.25e-10, Kgap = -1.40e-09) 

Evaluating 252 points to refine on ...
Mean level of abs(aH): 0.130839. Maximum level of grid: 7. 
Nodes coarsened: 6, children added: 322, parents added: 4, 
Net change: 311 -> 631 = << 320 >>, blacklisted: 6. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0397, K = 6.29),  markets(S = -3.76e-18,  Y-C-I = 1.90e-12, Kgap = 2.12e-11) 

Evaluating 419 points to refine on ...
Mean level of abs(aH): 0.0647056. Maximum level of grid: 8. 
Nodes coarsened: 39, children added: 406, parents added: 6, 
Net change: 631 -> 1004 = << 373 >>, blacklisted: 45. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0398, K = 6.28),  markets(S = 1.44e-19,  Y-C-I = 1.21e-11, Kgap = 1.35e-10) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('Hbasis_small', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/Hbasis_small.m', 9)" style="font-weight:bold">Hbasis_small</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/Hbasis_small.m',9,0)">line 9</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sparseProject', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m', 9)" style="font-weight:bold">sparseProject</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m',9,0)">line 9</a>)
        BH = Hbasis_small(points(i,:), G.grid, G.lvl, G.h);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 129)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',129,0)">line 129</a>)
    Vtest(k) = sparseProject(ssFine.V, points(k,:), GFine);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0377, K = 6.50),  markets(S = -1.92e-18,  Y-C-I = 2.07e-14, Kgap = 2.40e-13) 

Evaluating 51 points to refine on ...
Mean level of abs(aH): 0.889042. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 82, parents added: 0, 
Net change: 51 -> 133 = << 82 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0389, K = 6.37),  markets(S = -9.06e-18,  Y-C-I = -2.58e-14, Kgap = -2.95e-13) 

Evaluating 131 points to refine on ...
Mean level of abs(aH): 0.349607. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 192, parents added: 0, 
Net change: 133 -> 325 = << 192 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0394, K = 6.32),  markets(S = -6.15e-18,  Y-C-I = 3.82e-13, Kgap = 4.28e-12) 

Evaluating 275 points to refine on ...
Mean level of abs(aH): 0.144091. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 353, parents added: 3, 
Net change: 325 -> 680 = << 355 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0396, K = 6.30),  markets(S = -7.11e-18,  Y-C-I = -2.72e-14, Kgap = -3.08e-13) 

Evaluating 467 points to refine on ...
Mean level of abs(aH): 0.0690388. Maximum level of grid: 8. 
Nodes coarsened: 26, children added: 462, parents added: 11, 
Net change: 680 -> 1127 = << 447 >>, blacklisted: 27. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_FD', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD.m', 46)" style="font-weight:bold">gen_FD</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD.m',46,0)">line 46</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 26)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',26,0)">line 26</a>)
G = gen_FD(G, BC);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In finDiffEvalAndChkErr

In finitedifferences

In computeFinDiffGradAndJac

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 255)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',255,0)">line 255</a>)
        [JAC,~,~,numFDfevals,evalOK] = computeFinDiffGradAndJac(x,funfcn,confcn,Fvec, ...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0488, K = 5.44),  markets(S = -1.69e-17,  Y-C-I = 3.64e-01, Kgap = 1.89e-03) 

Evaluating 16 points to refine on ...
Mean level of abs(aH): 1046.33. Maximum level of grid: 4. 
Nodes coarsened: 14, children added: 10, parents added: 0, 
Net change: 51 -> 47 = << -4 >>, blacklisted: 14. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0631, K = 4.45),  markets(S = 1.72e-16,  Y-C-I = -1.35e+00, Kgap = -1.44e+01) 

Evaluating 47 points to refine on ...
Mean level of abs(aH): 5.15557. Maximum level of grid: 5. 
Nodes coarsened: 0, children added: 57, parents added: 0, 
Net change: 47 -> 104 = << 57 >>, blacklisted: 14. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0631, K = 4.45),  markets(S = 1.32e-16,  Y-C-I = -4.22e-01, Kgap = -6.35e+00) 

Evaluating 104 points to refine on ...
Mean level of abs(aH): 3.34942. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 141, parents added: 11, 
Net change: 104 -> 256 = << 152 >>, blacklisted: 14. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('vec_x_spijs', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/vec_x_spijs.m', 14)" style="font-weight:bold">vec_x_spijs</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/vec_x_spijs.m',14,0)">line 14</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('FDoperator', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/FDoperator.m', 28)" style="font-weight:bold">FDoperator</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/FDoperator.m',28,0)">line 28</a>)
                   vec_x_spijs(MU(:,i) .* (MU(:,i) <  0), G.(['DSijs_', BC_name]).D1B{k})];

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('KF', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/KF.m', 3)" style="font-weight:bold">KF</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/KF.m',3,0)">line 3</a>)
Az = FDoperator(G, param.theta_z * (param.zmean - G.z), param.sig_z*ones(G.J,1), 2);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 42)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',42,0)">line 42</a>)
g = KF(sDense, GDense, param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0465, K = 5.64),  markets(S = -4.06e-17,  Y-C-I = 3.69e-01, Kgap = 5.05e-03) 

Evaluating 16 points to refine on ...
Mean level of abs(aH): 493.707. Maximum level of grid: 5. 
Nodes coarsened: 56, children added: 10, parents added: 0, 
Net change: 99 -> 53 = << -46 >>, blacklisted: 56. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0579, K = 4.77),  markets(S = 2.07e-16,  Y-C-I = -1.06e+00, Kgap = -1.24e+01) 

Evaluating 53 points to refine on ...
Mean level of abs(aH): 3.91373. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 48, parents added: 0, 
Net change: 53 -> 101 = << 48 >>, blacklisted: 56. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.16e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.16e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.16e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 3.24e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 3.24e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 3.24e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.16e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.77e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.77e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.77e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 3.24e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.71e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.79e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.78e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.78e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.78e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.79e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.79e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.79e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.81e+02
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.80e+02
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0387, K = 6.40),  markets(S = -3.57e-18,  Y-C-I = 1.09e-14, Kgap = 1.20e-13) 

Evaluating 97 points to refine on ...
Mean level of abs(aH): 0.475201. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 158, parents added: 1, 
Net change: 99 -> 258 = << 159 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0393, K = 6.33),  markets(S = -6.35e-18,  Y-C-I = 4.57e-14, Kgap = 5.04e-13) 

Evaluating 232 points to refine on ...
Mean level of abs(aH): 0.18467. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 327, parents added: 0, 
Net change: 258 -> 585 = << 327 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0396, K = 6.30),  markets(S = -3.40e-18,  Y-C-I = -9.91e-14, Kgap = -1.11e-12) 

Evaluating 414 points to refine on ...
Mean level of abs(aH): 0.0812208. Maximum level of grid: 8. 
Nodes coarsened: 20, children added: 438, parents added: 3, 
Net change: 585 -> 1006 = << 421 >>, blacklisted: 20. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0397, K = 6.29),  markets(S = -6.28e-18,  Y-C-I = -2.47e-13, Kgap = -2.75e-12) 

Evaluating 572 points to refine on ...
Mean level of abs(aH): 0.0470488. Maximum level of grid: 9. 
Nodes coarsened: 33, children added: 373, parents added: 8, 
Net change: 1006 -> 1354 = << 348 >>, blacklisted: 53. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0397, K = 6.28),  markets(S = -5.08e-18,  Y-C-I = 3.65e-12, Kgap = 4.07e-11) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 125)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',125,0)">line 125</a>)
[~,~,~,ssFine] = stationary([ss.K, ss.tau], GFine, GDense, param);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0386, K = 6.40),  markets(S = -9.68e-18,  Y-C-I = -2.40e-12, Kgap = -2.71e-11) 

Evaluating 145 points to refine on ...
Mean level of abs(aH): 0.281486. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 214, parents added: 0, 
Net change: 165 -> 379 = << 214 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0391, K = 6.35),  markets(S = -1.68e-18,  Y-C-I = 1.65e-13, Kgap = 1.86e-12) 

Evaluating 306 points to refine on ...
Mean level of abs(aH): 0.123161. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 392, parents added: 0, 
Net change: 379 -> 770 = << 391 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0394, K = 6.32),  markets(S = -1.08e-18,  Y-C-I = -3.66e-15, Kgap = -4.53e-14) 

Evaluating 525 points to refine on ...
Mean level of abs(aH): 0.060695. Maximum level of grid: 8. 
Nodes coarsened: 21, children added: 526, parents added: 3, 
Net change: 770 -> 1278 = << 508 >>, blacklisted: 22. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0395, K = 6.31),  markets(S = -6.61e-18,  Y-C-I = 9.60e-13, Kgap = 1.07e-11) 

Evaluating 713 points to refine on ...
Mean level of abs(aH): 0.036584. Maximum level of grid: 9. 
Nodes coarsened: 35, children added: 462, parents added: 2, 
Net change: 1278 -> 1707 = << 429 >>, blacklisted: 57. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0395, K = 6.31),  markets(S = -8.89e-18,  Y-C-I = -5.70e-12, Kgap = -6.36e-11) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('deriv_sparse', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/deriv_sparse.m', 25)" style="font-weight:bold">deriv_sparse</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/fd/deriv_sparse.m',25,0)">line 25</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('HJB', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/HJB.m', 7)" style="font-weight:bold">HJB</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/HJB.m',7,0)">line 7</a>)
VkF = deriv_sparse(G, V, 1, 'D1F');

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 12)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',12,0)">line 12</a>)
hjb = HJB(V, G, param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 125)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',125,0)">line 125</a>)
[~,~,~,ssFine] = stationary([ss.K, ss.tau], GFine, GDense, param);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0430, K = 5.96),  markets(S = 6.95e-17,  Y-C-I = 7.51e-01, Kgap = 4.27e-03) 

Evaluating 44 points to refine on ...
Mean level of abs(aH): 352.843. Maximum level of grid: 6. 
Nodes coarsened: 68, children added: 30, parents added: 0, 
Net change: 165 -> 127 = << -38 >>, blacklisted: 68. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.95e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.95e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.95e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.94e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.94e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.94e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.94e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.94e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.95e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.95e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.95e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.96e+03
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 210)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',210,0)">line 210</a>)
    F = feval(funfcn{3},reshape(xTrial,sizes.xShape),varargin{:});

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0288, K = 7.64),  markets(S = -1.81e-17,  Y-C-I = 5.80e-01, Kgap = 2.20e+00) 

Evaluating 24 points to refine on ...
Mean level of abs(aH): 1.98134e+06. Maximum level of grid: 7. 
Nodes coarsened: 561, children added: 32, parents added: 17, 
Net change: 585 -> 73 = << -512 >>, blacklisted: 561. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.19e-07
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.42e-07
Stationary Equilibrium: (r = 0.0346, K = 6.86),  markets(S = 3.95e-19,  Y-C-I = 1.23e-02, Kgap = 7.20e-08) 

Evaluating 73 points to refine on ...
Mean level of abs(aH): 0.582969. Maximum level of grid: 8. 
Nodes coarsened: 0, children added: 106, parents added: 32, 
Net change: 73 -> 211 = << 138 >>, blacklisted: 561. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0283, K = 7.71),  markets(S = 7.81e-04,  Y-C-I = 7.81e-04, Kgap = 8.93e-13) 

Evaluating 210 points to refine on ...
Mean level of abs(aH): 0.230188. Maximum level of grid: 9. 
Nodes coarsened: 0, children added: 275, parents added: 42, 
Net change: 211 -> 528 = << 317 >>, blacklisted: 561. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0289, K = 7.62),  markets(S = 4.93e-04,  Y-C-I = 4.93e-04, Kgap = -4.09e-10) 

Evaluating 425 points to refine on ...
Mean level of abs(aH): 0.0940174. Maximum level of grid: 10. 
Nodes coarsened: 4, children added: 481, parents added: 81, 
Net change: 528 -> 1086 = << 558 >>, blacklisted: 565. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0290, K = 7.60),  markets(S = 7.13e-04,  Y-C-I = 7.13e-04, Kgap = 2.32e-12) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_FD_interior', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD_interior.m', 19)" style="font-weight:bold">gen_FD_interior</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD_interior.m',19,0)">line 19</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_derived_fields', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m', 23)" style="font-weight:bold">gen_derived_fields</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m',23,0)">line 23</a>)
    G = gen_FD_interior(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('setup_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m', 51)" style="font-weight:bold">setup_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m',51,0)">line 51</a>)
G = gen_derived_fields(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 121)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',121,0)">line 121</a>)
GFine = setup_grid(0, param.surplusFine, param.min, param.max, 'named_dims', {1,2}, 'names', {'k','z'}, 'dxx_dims', 2);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0296, K = 7.52),  markets(S = -8.61e-18,  Y-C-I = -7.44e-15, Kgap = -9.86e-14) 

Evaluating 313 points to refine on ...
Mean level of abs(aH): 0.0888148. Maximum level of grid: 7. 
Nodes coarsened: 145, children added: 372, parents added: 7, 
Net change: 585 -> 819 = << 234 >>, blacklisted: 145. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0297, K = 7.50),  markets(S = -6.64e-18,  Y-C-I = 4.03e-13, Kgap = 5.06e-12) 

Evaluating 525 points to refine on ...
Mean level of abs(aH): 0.0634588. Maximum level of grid: 8. 
Nodes coarsened: 17, children added: 516, parents added: 7, 
Net change: 819 -> 1325 = << 506 >>, blacklisted: 161. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0298, K = 7.49),  markets(S = -6.06e-18,  Y-C-I = -8.45e-14, Kgap = -1.06e-12) 

Evaluating 712 points to refine on ...
Mean level of abs(aH): 0.0392459. Maximum level of grid: 9. 
Nodes coarsened: 31, children added: 454, parents added: 29, 
Net change: 1325 -> 1777 = << 452 >>, blacklisted: 191. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0298, K = 7.49),  markets(S = -9.89e-18,  Y-C-I = 1.24e-11, Kgap = 1.55e-10) 

Evaluating 878 points to refine on ...
Mean level of abs(aH): 0.0292719. Maximum level of grid: 10. 
Nodes coarsened: 41, children added: 411, parents added: 109, 
Net change: 1777 -> 2256 = << 479 >>, blacklisted: 229. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In finDiffEvalAndChkErr

In finitedifferences

In computeFinDiffGradAndJac

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 255)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',255,0)">line 255</a>)
        [JAC,~,~,numFDfevals,evalOK] = computeFinDiffGradAndJac(x,funfcn,confcn,Fvec, ...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0295, K = 7.53),  markets(S = -7.46e-18,  Y-C-I = 8.39e-13, Kgap = 1.05e-11) 

Evaluating 334 points to refine on ...
Mean level of abs(aH): 0.099522. Maximum level of grid: 7. 
Nodes coarsened: 98, children added: 404, parents added: 1, 
Net change: 585 -> 892 = << 307 >>, blacklisted: 98. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0296, K = 7.51),  markets(S = -2.54e-18,  Y-C-I = 5.64e-13, Kgap = 7.08e-12) 

Evaluating 552 points to refine on ...
Mean level of abs(aH): 0.0652257. Maximum level of grid: 8. 
Nodes coarsened: 16, children added: 522, parents added: 20, 
Net change: 892 -> 1418 = << 526 >>, blacklisted: 113. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0297, K = 7.50),  markets(S = -4.32e-18,  Y-C-I = -4.00e-12, Kgap = -5.02e-11) 

Evaluating 747 points to refine on ...
Mean level of abs(aH): 0.0410133. Maximum level of grid: 9. 
Nodes coarsened: 36, children added: 456, parents added: 55, 
Net change: 1418 -> 1893 = << 475 >>, blacklisted: 147. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0297, K = 7.50),  markets(S = -6.94e-18,  Y-C-I = 1.20e-11, Kgap = 1.51e-10) 

Evaluating 943 points to refine on ...
Mean level of abs(aH): 0.0307231. Maximum level of grid: 10. 
Nodes coarsened: 40, children added: 487, parents added: 84, 
Net change: 1893 -> 2424 = << 531 >>, blacklisted: 182. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0297, K = 7.50),  markets(S = -9.93e-18,  Y-C-I = -5.71e-11, Kgap = -7.16e-10) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_FD', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD.m', 46)" style="font-weight:bold">gen_FD</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD.m',46,0)">line 46</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 26)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',26,0)">line 26</a>)
G = gen_FD(G, BC);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 125)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',125,0)">line 125</a>)
[~,~,~,ssFine] = stationary([ss.K, ss.tau], GFine, GDense, param);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0246, K = 8.28),  markets(S = -6.60e-18,  Y-C-I = 3.00e-14, Kgap = 4.07e-13) 

Evaluating 333 points to refine on ...
Mean level of abs(aH): 0.106904. Maximum level of grid: 7. 
Nodes coarsened: 104, children added: 400, parents added: 1, 
Net change: 585 -> 882 = << 297 >>, blacklisted: 104. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0247, K = 8.26),  markets(S = 1.07e-18,  Y-C-I = -2.39e-14, Kgap = -3.20e-13) 

Evaluating 547 points to refine on ...
Mean level of abs(aH): 0.070815. Maximum level of grid: 8. 
Nodes coarsened: 17, children added: 513, parents added: 16, 
Net change: 882 -> 1394 = << 512 >>, blacklisted: 121. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0248, K = 8.25),  markets(S = 3.58e-18,  Y-C-I = -1.63e-13, Kgap = -2.18e-12) 

Evaluating 733 points to refine on ...
Mean level of abs(aH): 0.0447735. Maximum level of grid: 9. 
Nodes coarsened: 27, children added: 438, parents added: 57, 
Net change: 1394 -> 1862 = << 468 >>, blacklisted: 147. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0248, K = 8.25),  markets(S = -7.22e-18,  Y-C-I = -1.27e-10, Kgap = -1.70e-09) 

Evaluating 927 points to refine on ...
Mean level of abs(aH): 0.0335167. Maximum level of grid: 10. 
Nodes coarsened: 33, children added: 495, parents added: 73, 
Net change: 1862 -> 2397 = << 535 >>, blacklisted: 178. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0248, K = 8.25),  markets(S = -6.55e-18,  Y-C-I = -1.56e-11, Kgap = -2.09e-10) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_FD_interior', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD_interior.m', 25)" style="font-weight:bold">gen_FD_interior</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD_interior.m',25,0)">line 25</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_derived_fields', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m', 23)" style="font-weight:bold">gen_derived_fields</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m',23,0)">line 23</a>)
    G = gen_FD_interior(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('setup_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m', 51)" style="font-weight:bold">setup_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m',51,0)">line 51</a>)
G = gen_derived_fields(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 121)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',121,0)">line 121</a>)
GFine = setup_grid(0, param.surplusFine, param.min, param.max, 'named_dims', {1,2}, 'names', {'k','z'}, 'dxx_dims', 2);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0244, K = 8.31),  markets(S = -1.42e-17,  Y-C-I = 1.10e-13, Kgap = 1.48e-12) 

Evaluating 146 points to refine on ...
Mean level of abs(aH): 0.379048. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 218, parents added: 0, 
Net change: 165 -> 383 = << 218 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0246, K = 8.28),  markets(S = -8.78e-18,  Y-C-I = -2.35e-14, Kgap = -3.18e-13) 

Evaluating 315 points to refine on ...
Mean level of abs(aH): 0.163322. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 410, parents added: 0, 
Net change: 383 -> 792 = << 409 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0247, K = 8.26),  markets(S = -5.12e-18,  Y-C-I = 1.79e-13, Kgap = 2.41e-12) 

Evaluating 515 points to refine on ...
Mean level of abs(aH): 0.078908. Maximum level of grid: 8. 
Nodes coarsened: 23, children added: 486, parents added: 18, 
Net change: 792 -> 1273 = << 481 >>, blacklisted: 24. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0248, K = 8.25),  markets(S = -5.78e-18,  Y-C-I = -2.65e-13, Kgap = -3.54e-12) 

Evaluating 700 points to refine on ...
Mean level of abs(aH): 0.0490576. Maximum level of grid: 9. 
Nodes coarsened: 27, children added: 449, parents added: 56, 
Net change: 1273 -> 1751 = << 478 >>, blacklisted: 51. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main>@(x)stationary(x,G,GDense,param)', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main>@(x)stationary(x,G,GDense,param)</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);

In finDiffEvalAndChkErr

In finitedifferences

In computeFinDiffGradAndJac

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('trustnleqn', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m', 255)" style="font-weight:bold">trustnleqn</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/private/trustnleqn.m',255,0)">line 255</a>)
        [JAC,~,~,numFDfevals,evalOK] = computeFinDiffGradAndJac(x,funfcn,confcn,Fvec, ...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('fsolve', '/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m', 436)" style="font-weight:bold">fsolve</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/optim/optim/fsolve.m',436,0)">line 436</a>)
        trustnleqn(funfcn,x,verbosity,gradflag,options,defaultopt,optimgetFlag,f,JAC,...

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 89)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',89,0)">line 89</a>)
    X = fsolve(@(x) stationary(x, G, GDense, param), X0, options);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Complex values in VFI: terminating process.Complex values in VFI: terminating process.Complex values in VFI: terminating process.Complex values in VFI: terminating process.Stationary Equilibrium: (r = -31448.5411, K = -0.00),  markets(S = 00,  Y-C-I = 3.83e-04, Kgap = -1.22e-08) 

Evaluating 0 points to refine on ...
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('mpower', '/Applications/MATLAB_R2021a.app/toolbox/matlab/ops/mpower.m', 51)" style="font-weight:bold"> ^ </a> (<a href="matlab: opentoline('/Applications/MATLAB_R2021a.app/toolbox/matlab/ops/mpower.m',51,0)">line 51</a>)
Incorrect dimensions for raising a matrix to a power. Check that the matrix is square and the power is a scalar. To perform elementwise
matrix powers, use '.^'.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('add_parents>find_parents', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m', 63)" style="font-weight:bold">add_parents>find_parents</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m',63,0)">line 63</a>)
    nmax = 2^maxl;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('add_parents', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m', 4)" style="font-weight:bold">add_parents</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/add_parents.m',4,0)">line 4</a>)
    [parentMat, fullGridVec, lVec] = find_parents(maxl);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('adapt_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/adapt_grid.m', 110)" style="font-weight:bold">adapt_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/adapt_grid.m',110,0)">line 110</a>)
    [parents, parentLevels] = add_parents(gridNew, lvlNew);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 102)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',102,0)">line 102</a>)
    [G, BH_adapt, blacklist, stats] = adapt_grid(G, ss.V, blacklist, ...
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0244, K = 8.31),  markets(S = -1.42e-17,  Y-C-I = 1.10e-13, Kgap = 1.48e-12) 

Evaluating 146 points to refine on ...
Mean level of abs(aH): 0.379048. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 218, parents added: 0, 
Net change: 165 -> 383 = << 218 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0246, K = 8.28),  markets(S = -8.78e-18,  Y-C-I = -2.35e-14, Kgap = -3.18e-13) 

Evaluating 315 points to refine on ...
Mean level of abs(aH): 0.163322. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 410, parents added: 0, 
Net change: 383 -> 792 = << 409 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0247, K = 8.26),  markets(S = -5.12e-18,  Y-C-I = 1.79e-13, Kgap = 2.41e-12) 

Evaluating 515 points to refine on ...
Mean level of abs(aH): 0.078908. Maximum level of grid: 8. 
Nodes coarsened: 23, children added: 486, parents added: 18, 
Net change: 792 -> 1273 = << 481 >>, blacklisted: 24. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0248, K = 8.25),  markets(S = -5.78e-18,  Y-C-I = -2.65e-13, Kgap = -3.54e-12) 

Evaluating 700 points to refine on ...
Mean level of abs(aH): 0.0490576. Maximum level of grid: 9. 
Nodes coarsened: 27, children added: 449, parents added: 56, 
Net change: 1273 -> 1751 = << 478 >>, blacklisted: 51. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0248, K = 8.25),  markets(S = -1.36e-17,  Y-C-I = -9.20e-11, Kgap = -1.23e-09) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 125)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',125,0)">line 125</a>)
[~,~,~,ssFine] = stationary([ss.K, ss.tau], GFine, GDense, param);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.19),  markets(S = -2.85e-18,  Y-C-I = 6.05e-14, Kgap = 8.65e-13) 

Evaluating 146 points to refine on ...
Mean level of abs(aH): 0.419205. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 218, parents added: 0, 
Net change: 165 -> 383 = << 218 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = -4.79e-18,  Y-C-I = -1.28e-13, Kgap = -1.83e-12) 

Evaluating 309 points to refine on ...
Mean level of abs(aH): 0.1803. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 398, parents added: 0, 
Net change: 383 -> 780 = << 397 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = -7.14e-18,  Y-C-I = -5.93e-11, Kgap = -8.50e-10) 

Evaluating 502 points to refine on ...
Mean level of abs(aH): 0.0884116. Maximum level of grid: 8. 
Nodes coarsened: 25, children added: 479, parents added: 16, 
Net change: 780 -> 1250 = << 470 >>, blacklisted: 26. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -1.07e-17,  Y-C-I = 3.63e-12, Kgap = 5.20e-11) 

Evaluating 685 points to refine on ...
Mean level of abs(aH): 0.0551211. Maximum level of grid: 9. 
Nodes coarsened: 29, children added: 453, parents added: 58, 
Net change: 1250 -> 1732 = << 482 >>, blacklisted: 53. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -5.87e-18,  Y-C-I = -1.58e-11, Kgap = -2.26e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.73e+00  with # grid points: 165
L_inf norm |V_tpg2 - Vfine| = 1.29e+00  with # grid points: 585
L_inf norm |V_tpg3 - Vfine| = 5.76e-01  with # grid points: 2193
L_inf norm |V_tpg4 - Vfine| = 2.47e-01  with # grid points: 8481
L_inf norm |V_tpg5 - Vfine| = 8.26e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.73e+00  with # grid points: 165
L_inf norm |V_sg2 - Vfine| = 1.27e+00  with # grid points: 457
L_inf norm |V_sg3 - Vfine| = 5.50e-01  with # grid points: 1169
L_inf norm |V_sg4 - Vfine| = 2.21e-01  with # grid points: 2849
L_inf norm |V_sg5 - Vfine| = 6.00e-02  with # grid points: 6721


Algorithm converged. Run-time of: 90.11 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.19),  markets(S = -2.85e-18,  Y-C-I = 6.05e-14, Kgap = 8.65e-13) 

Evaluating 146 points to refine on ...
Mean level of abs(aH): 0.419205. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 218, parents added: 0, 
Net change: 165 -> 383 = << 218 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = -4.79e-18,  Y-C-I = -1.28e-13, Kgap = -1.83e-12) 

Evaluating 309 points to refine on ...
Mean level of abs(aH): 0.1803. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 398, parents added: 0, 
Net change: 383 -> 780 = << 397 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = -7.14e-18,  Y-C-I = -5.93e-11, Kgap = -8.50e-10) 

Evaluating 502 points to refine on ...
Mean level of abs(aH): 0.0884116. Maximum level of grid: 8. 
Nodes coarsened: 25, children added: 479, parents added: 16, 
Net change: 780 -> 1250 = << 470 >>, blacklisted: 26. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -1.07e-17,  Y-C-I = 3.63e-12, Kgap = 5.20e-11) 

Evaluating 685 points to refine on ...
Mean level of abs(aH): 0.0551211. Maximum level of grid: 9. 
Nodes coarsened: 29, children added: 453, parents added: 58, 
Net change: 1250 -> 1732 = << 482 >>, blacklisted: 53. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -5.87e-18,  Y-C-I = -1.58e-11, Kgap = -2.26e-10) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sparseProject', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m', 7)" style="font-weight:bold">sparseProject</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m',7,0)">line 7</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 129)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',129,0)">line 129</a>)
    Vtest(k) = sparseProject(ssFine.V, points(k,:), GFine);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.19),  markets(S = -2.44e-18,  Y-C-I = 8.75e-14, Kgap = 1.25e-12) 

Evaluating 152 points to refine on ...
Mean level of abs(aH): 0.420512. Maximum level of grid: 6. 
Nodes coarsened: 1, children added: 242, parents added: 1, 
Net change: 165 -> 407 = << 242 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = -1.09e-17,  Y-C-I = -5.52e-14, Kgap = -7.89e-13) 

Evaluating 324 points to refine on ...
Mean level of abs(aH): 0.170353. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 414, parents added: 11, 
Net change: 407 -> 831 = << 424 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -4.91e-18,  Y-C-I = 5.17e-13, Kgap = 7.41e-12) 

Evaluating 534 points to refine on ...
Mean level of abs(aH): 0.0833469. Maximum level of grid: 8. 
Nodes coarsened: 21, children added: 517, parents added: 8, 
Net change: 831 -> 1335 = << 504 >>, blacklisted: 23. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -3.94e-18,  Y-C-I = -1.42e-12, Kgap = -2.03e-11) 

Evaluating 717 points to refine on ...
Mean level of abs(aH): 0.0518506. Maximum level of grid: 9. 
Nodes coarsened: 30, children added: 447, parents added: 76, 
Net change: 1335 -> 1828 = << 493 >>, blacklisted: 52. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0199, K = 9.13),  markets(S = -6.91e-18,  Y-C-I = -1.12e-10, Kgap = -1.61e-09) 

{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_H_mat2', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_H_mat2.m', 46)" style="font-weight:bold">gen_H_mat2</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_H_mat2.m',46,0)">line 46</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_FD_interior', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD_interior.m', 18)" style="font-weight:bold">gen_FD_interior</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_FD_interior.m',18,0)">line 18</a>)
    [~, boundHk] = gen_H_mat2(boundGrid, boundLvl, k);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('gen_derived_fields', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m', 23)" style="font-weight:bold">gen_derived_fields</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/gen_derived_fields.m',23,0)">line 23</a>)
    G = gen_FD_interior(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('setup_grid', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m', 51)" style="font-weight:bold">setup_grid</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/setup_grid.m',51,0)">line 51</a>)
G = gen_derived_fields(G);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 121)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',121,0)">line 121</a>)
GFine = setup_grid(0, param.surplusFine, param.min, param.max, 'named_dims', {1,2}, 'names', {'k','z'}, 'dxx_dims', 2);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.18),  markets(S = 6.56e-19,  Y-C-I = 8.61e-14, Kgap = 1.23e-12) 

Evaluating 153 points to refine on ...
Mean level of abs(aH): 0.418425. Maximum level of grid: 6. 
Nodes coarsened: 1, children added: 248, parents added: 2, 
Net change: 165 -> 414 = << 249 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = -3.28e-18,  Y-C-I = -5.72e-10, Kgap = -8.20e-09) 

Evaluating 338 points to refine on ...
Mean level of abs(aH): 0.166701. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 435, parents added: 6, 
Net change: 414 -> 853 = << 439 >>, blacklisted: 3. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -4.09e-18,  Y-C-I = -3.95e-14, Kgap = -5.67e-13) 

Evaluating 550 points to refine on ...
Mean level of abs(aH): 0.0808894. Maximum level of grid: 8. 
Nodes coarsened: 10, children added: 524, parents added: 16, 
Net change: 853 -> 1383 = << 530 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0199, K = 9.13),  markets(S = -4.88e-18,  Y-C-I = 4.54e-12, Kgap = 6.49e-11) 

Evaluating 743 points to refine on ...
Mean level of abs(aH): 0.0498507. Maximum level of grid: 9. 
Nodes coarsened: 36, children added: 487, parents added: 84, 
Net change: 1383 -> 1918 = << 535 >>, blacklisted: 49. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0199, K = 9.13),  markets(S = -3.80e-18,  Y-C-I = 1.81e-11, Kgap = 2.60e-10) 

L_inf norm |V_tpg1 - Vfine| = 2.73e+00  with # grid points: 165
L_inf norm |V_tpg2 - Vfine| = 1.29e+00  with # grid points: 585
L_inf norm |V_tpg3 - Vfine| = 5.76e-01  with # grid points: 2193
L_inf norm |V_tpg4 - Vfine| = 2.47e-01  with # grid points: 8481
L_inf norm |V_tpg5 - Vfine| = 8.26e-02  with # grid points: 33345
L_inf norm |V_sg1 - Vfine| = 2.73e+00  with # grid points: 165
L_inf norm |V_sg2 - Vfine| = 1.27e+00  with # grid points: 457
L_inf norm |V_sg3 - Vfine| = 5.50e-01  with # grid points: 1169
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 3.57e+04
{Unable to perform assignment because the size of the left side is 1-by-1 and the size of the right side is 1-by-2849.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sparseProject', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m', 10)" style="font-weight:bold">sparseProject</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m',10,0)">line 10</a>)
        xProject(i, :) = BH * xH;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 164)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',164,0)">line 164</a>)
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
} 
opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',164,0)
param.Delta

ans =

        1000

param.Delta=100;
for j = 1:param.fineLevel %+2
    
    GSG{j} = setup_grid(j-1, param.surplus, param.min, param.max, 'named_dims', {1,2}, 'names', {'k','z'}, 'dxx_dims', 2);
    GSG{j}.BHDense = get_projection_matrix(GDense.grid, GDense.lvl, GSG{j});
    
    [~,~,~,ssSG{j}] = stationary([ss.K, ss.tau], GSG{j}, GDense, param);
    
    Vtest = zeros(P,1);
    for k = 1:P
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
    end
    GSG{j}.Vtest = Vtest;
    GSG{j}.normInf = norm(GSG{j}.Vtest - GFine.Vtest, Inf);

    fprintf('L_inf norm |V_sg%.i - Vfine| = %.2d  with # grid points: %.i\n', ...
        j, GSG{j}.normInf, GSG{j}.J);

end
L_inf norm |V_sg1 - Vfine| = 2.73e+00  with # grid points: 165
L_inf norm |V_sg2 - Vfine| = 1.27e+00  with # grid points: 457
L_inf norm |V_sg3 - Vfine| = 5.50e-01  with # grid points: 1169
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 2.73e+12
{Unable to perform assignment because the size of the left side is 1-by-1 and the size of the right side is 1-by-2849.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sparseProject', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m', 10)" style="font-weight:bold">sparseProject</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m',10,0)">line 10</a>)
        xProject(i, :) = BH * xH;
} 
param.Delta=10; param.maxit=5000;
for j = 1:param.fineLevel %+2
    
    GSG{j} = setup_grid(j-1, param.surplus, param.min, param.max, 'named_dims', {1,2}, 'names', {'k','z'}, 'dxx_dims', 2);
    GSG{j}.BHDense = get_projection_matrix(GDense.grid, GDense.lvl, GSG{j});
    
    [~,~,~,ssSG{j}] = stationary([ss.K, ss.tau], GSG{j}, GDense, param);
    
    Vtest = zeros(P,1);
    for k = 1:P
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
    end
    GSG{j}.Vtest = Vtest;
    GSG{j}.normInf = norm(GSG{j}.Vtest - GFine.Vtest, Inf);

    fprintf('L_inf norm |V_sg%.i - Vfine| = %.2d  with # grid points: %.i\n', ...
        j, GSG{j}.normInf, GSG{j}.J);

end
L_inf norm |V_sg1 - Vfine| = 2.73e+00  with # grid points: 165
L_inf norm |V_sg2 - Vfine| = 1.27e+00  with # grid points: 457
L_inf norm |V_sg3 - Vfine| = 5.50e-01  with # grid points: 1169
L_inf norm |V_sg4 - Vfine| = 2.20e-01  with # grid points: 2849
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);
} 
param.Delta=2; param.maxit=2000;
for j = 1:param.fineLevel %+2
    
    GSG{j} = setup_grid(j-1, param.surplus, param.min, param.max, 'named_dims', {1,2}, 'names', {'k','z'}, 'dxx_dims', 2);
    GSG{j}.BHDense = get_projection_matrix(GDense.grid, GDense.lvl, GSG{j});
    
    [~,~,~,ssSG{j}] = stationary([ss.K, ss.tau], GSG{j}, GDense, param);
    
    Vtest = zeros(P,1);
    for k = 1:P
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
    end
    GSG{j}.Vtest = Vtest;
    GSG{j}.normInf = norm(GSG{j}.Vtest - GFine.Vtest, Inf);

    fprintf('L_inf norm |V_sg%.i - Vfine| = %.2d  with # grid points: %.i\n', ...
        j, GSG{j}.normInf, GSG{j}.J);

end
L_inf norm |V_sg1 - Vfine| = 2.73e+00  with # grid points: 165
L_inf norm |V_sg2 - Vfine| = 1.27e+00  with # grid points: 457
L_inf norm |V_sg3 - Vfine| = 5.50e-01  with # grid points: 1169
L_inf norm |V_sg4 - Vfine| = 2.20e-01  with # grid points: 2849
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.18),  markets(S = -1.12e-17,  Y-C-I = -1.63e-12, Kgap = -2.34e-11) 

Evaluating 152 points to refine on ...
Mean level of abs(aH): 0.419921. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 240, parents added: 0, 
Net change: 165 -> 405 = << 240 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = -1.36e-17,  Y-C-I = 1.49e-13, Kgap = 2.15e-12) 

Evaluating 317 points to refine on ...
Mean level of abs(aH): 0.171153. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 400, parents added: 15, 
Net change: 405 -> 818 = << 413 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -7.73e-18,  Y-C-I = 4.95e-13, Kgap = 7.09e-12) 

Evaluating 530 points to refine on ...
Mean level of abs(aH): 0.0846555. Maximum level of grid: 8. 
Nodes coarsened: 12, children added: 522, parents added: 9, 
Net change: 818 -> 1337 = << 519 >>, blacklisted: 14. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0199, K = 9.13),  markets(S = 4.40e-19,  Y-C-I = -9.34e-13, Kgap = -1.34e-11) 

Evaluating 716 points to refine on ...
Mean level of abs(aH): 0.0517679. Maximum level of grid: 9. 
Nodes coarsened: 33, children added: 462, parents added: 79, 
Net change: 1337 -> 1845 = << 508 >>, blacklisted: 45. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0199, K = 9.13),  markets(S = -4.84e-18,  Y-C-I = -1.03e-11, Kgap = -1.48e-10) 

Evaluating 918 points to refine on ...
Mean level of abs(aH): 0.0375112. Maximum level of grid: 10. 
Nodes coarsened: 47, children added: 504, parents added: 77, 
Net change: 1845 -> 2379 = << 534 >>, blacklisted: 88. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0199, K = 9.13),  markets(S = -2.08e-18,  Y-C-I = 4.40e-11, Kgap = 6.30e-10) 

Evaluating 1096 points to refine on ...
Mean level of abs(aH): 0.029104. Maximum level of grid: 11. 
Nodes coarsened: 106, children added: 468, parents added: 178, 
Net change: 2379 -> 2919 = << 540 >>, blacklisted: 179. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0199, K = 9.13),  markets(S = -4.78e-18,  Y-C-I = -1.80e-10, Kgap = -2.57e-09) 

L_inf norm |V_tpg1 - Vfine| = 2.79e+00  with # grid points: 165
L_inf norm |V_tpg2 - Vfine| = 1.35e+00  with # grid points: 585
L_inf norm |V_tpg3 - Vfine| = 6.38e-01  with # grid points: 2193
L_inf norm |V_tpg4 - Vfine| = 3.09e-01  with # grid points: 8481
L_inf norm |V_tpg5 - Vfine| = 1.45e-01  with # grid points: 33345
L_inf norm |V_tpg6 - Vfine| = 6.25e-02  with # grid points: 132225
L_inf norm |V_tpg7 - Vfine| = 2.08e-02  with # grid points: 526593
L_inf norm |V_sg1 - Vfine| = 2.79e+00  with # grid points: 165
L_inf norm |V_sg2 - Vfine| = 1.34e+00  with # grid points: 457
L_inf norm |V_sg3 - Vfine| = 6.12e-01  with # grid points: 1169
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 1.31e+06
{Unable to perform assignment because the size of the left side is 1-by-1 and the size of the right side is 1-by-2849.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sparseProject', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m', 10)" style="font-weight:bold">sparseProject</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m',10,0)">line 10</a>)
        xProject(i, :) = BH * xH;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 164)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',164,0)">line 164</a>)
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
} 
param.Delta=2; param.maxit=2000;
for j = 1:param.fineLevel %+2
    
    GSG{j} = setup_grid(j-1, param.surplus, param.min, param.max, 'named_dims', {1,2}, 'names', {'k','z'}, 'dxx_dims', 2);
    GSG{j}.BHDense = get_projection_matrix(GDense.grid, GDense.lvl, GSG{j});
    
    [~,~,~,ssSG{j}] = stationary([ss.K, ss.tau], GSG{j}, GDense, param);
    
    Vtest = zeros(P,1);
    for k = 1:P
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
    end
    GSG{j}.Vtest = Vtest;
    GSG{j}.normInf = norm(GSG{j}.Vtest - GFine.Vtest, Inf);

    fprintf('L_inf norm |V_sg%.i - Vfine| = %.2d  with # grid points: %.i\n', ...
        j, GSG{j}.normInf, GSG{j}.J);

end
L_inf norm |V_sg1 - Vfine| = 2.79e+00  with # grid points: 165
L_inf norm |V_sg2 - Vfine| = 1.34e+00  with # grid points: 457
L_inf norm |V_sg3 - Vfine| = 6.12e-01  with # grid points: 1169
L_inf norm |V_sg4 - Vfine| = 2.83e-01  with # grid points: 2849
L_inf norm |V_sg5 - Vfine| = 1.22e-01  with # grid points: 6721
VFI did not converge. Remaining Gap: 2000
VFI did not converge. Remaining Gap: NaN
{Unable to perform assignment because the size of the left side is 1-by-1 and the size of the right side is 1-by-15489.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sparseProject', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m', 10)" style="font-weight:bold">sparseProject</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m',10,0)">line 10</a>)
        xProject(i, :) = BH * xH;
} 
for j = 1:adaptIter
    
    [~,~,~,ssASG{j}] = stationary([ss.K, ss.tau], G_adapt{j}, GDense, param);

    Vtest = zeros(P,1);
    for k = 1:P
        Vtest(k) = sparseProject(ssASG{j}.V, points(k,:), G_adapt{j});
    end
    G_adapt{j}.Vtest = Vtest;
    G_adapt{j}.normInf = norm(G_adapt{j}.Vtest - GFine.Vtest, Inf);
    
end


% Plot:
normASG=[];normSG=[];normTPG=[]; gridPointsASG=[];gridPointsSG=[];gridPointsTPG=[];
for j = 1:max([numel(G_adapt),numel(GSG),numel(GTPG)]) %param.fineLevel-1
    if j>numel(G_adapt)
        continue;
    else
        normASG(j) = G_adapt{j}.normInf;
        gridPointsASG(j) = G_adapt{j}.J;
    end
    
    if j>numel(GSG)
        continue;
    else
        normSG(j)  = GSG{j}.normInf;
        gridPointsSG(j)  = GSG{j}.J;
    end
    
    if j>numel(GTPG)
        continue;
    else
        normTPG(j) = GTPG{j}.normInf;
        gridPointsTPG(j) = GTPG{j}.J;
    end    
end
{Unrecognized field name "normInf".
} 
j

j =

     6

runTime = toc(runTime); fprintf('\n\nAlgorithm converged. Run-time of: %.2f seconds.\n',runTime);


Algorithm converged. Run-time of: 1925.92 seconds.
fprintf('\nPlotting Figures...\n');

Plotting Figures...
for n = 1:adaptIter
    
    figure('visible', 'off');
    subplot(1,2,1);
    l1=scatter3(G_adapt{n}.k, G_adapt{n}.z, V_adapt{n});
    xlabel('Capital: $k$','Interpreter','Latex');
        xlh = get(gca,'xlabel'); gxl = get(xlh); xlp = get(xlh, 'Position');
        set(xlh,'Rotation', 16,'Position',xlp,'VerticalAlignment','middle','HorizontalAlignment','left');
    ylabel('Earnings: $z$','Interpreter','Latex');
        ylh = get(gca,'ylabel'); gyl = get(ylh); ylp = get(ylh, 'Position');
        set(ylh,'Rotation',-27,'Position',ylp,'VerticalAlignment','middle','HorizontalAlignment','right');
    title('$V(a,z)$','Interpreter','Latex');
        
    subplot(1,2,2);
    l1=scatter3(G_adapt{n}.k, G_adapt{n}.z, c_adapt{n});
    xlabel('Capital: $k$','Interpreter','Latex');
        xlh = get(gca,'xlabel'); gxl = get(xlh); xlp = get(xlh, 'Position');
        set(xlh,'Rotation', 16,'Position',xlp,'VerticalAlignment','middle','HorizontalAlignment','left');
    ylabel('Earnings: $z$','Interpreter','Latex');
        ylh = get(gca,'ylabel'); gyl = get(ylh); ylp = get(ylh, 'Position');
        set(ylh,'Rotation',-27,'Position',ylp,'VerticalAlignment','middle','HorizontalAlignment','right');
    title('$c(a,z)$','Interpreter','Latex');
    
    set(gcf,'renderer','Painters', 'Position', [10 10 1200 400]);
    exportgraphics(gcf, ['./output/grid_adaptation', num2str(n-1), '.eps']);

end
figure('visible', 'off');
subplot(1,2,1); hold on;
l1 = plot(1:numel(normASG), normASG);
l2 = plot(1:numel(normSG), normSG);
l3 = plot(1:numel(normTPG), normTPG);
hold off; title('$L_\infty$ norm','Interpreter','Latex');
xlabel('Grid levels / adaptations');
legend([l1,l2,l3],{'Adaptive Sparse Grid', 'Regular Sparse Grid', 'Uniform Dense Grid'}, 'box', 'off');

subplot(1,2,2); hold on;
l1 = plot(1:numel(gridPointsASG), gridPointsASG);
l2 = plot(1:numel(gridPointsSG), gridPointsSG);
l3 = plot(1:numel(gridPointsTPG), gridPointsTPG);
hold off; title('Grid points','Interpreter','Latex');
xlabel('Grid levels / adaptations');
    
set(gcf,'renderer','Painters');
exportgraphics(gcf, './output/error1.eps');


figure('visible', 'off'); hold on;
l1 = plot(gridPointsASG, normASG); 
l2 = plot(gridPointsSG,  normSG);
l3 = plot(gridPointsTPG, normTPG);
hold off;
xlabel('Grid points'); 
title('$L_\infty$ norm','Interpreter','Latex');
set(gca, 'XScale','log', 'YScale','log');
    
legend([l1,l2,l3],{'Adaptive Sparse Grid', 'Regular Sparse Grid', 'Uniform Dense Grid'}, 'box', 'off');
set(gcf,'renderer','Painters');
exportgraphics(gcf, './output/error2.eps');

diary off
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.19),  markets(S = -2.85e-18,  Y-C-I = 6.05e-14, Kgap = 8.65e-13) 

Evaluating 146 points to refine on ...
Mean level of abs(aH): 0.419205. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 218, parents added: 0, 
Net change: 165 -> 383 = << 218 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = -4.79e-18,  Y-C-I = -1.28e-13, Kgap = -1.83e-12) 

Evaluating 309 points to refine on ...
Mean level of abs(aH): 0.1803. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 398, parents added: 0, 
Net change: 383 -> 780 = << 397 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = -7.14e-18,  Y-C-I = -5.93e-11, Kgap = -8.50e-10) 

Evaluating 502 points to refine on ...
Mean level of abs(aH): 0.0884116. Maximum level of grid: 8. 
Nodes coarsened: 25, children added: 479, parents added: 16, 
Net change: 780 -> 1250 = << 470 >>, blacklisted: 26. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -1.07e-17,  Y-C-I = 3.63e-12, Kgap = 5.20e-11) 

Evaluating 685 points to refine on ...
Mean level of abs(aH): 0.0551211. Maximum level of grid: 9. 
Nodes coarsened: 29, children added: 453, parents added: 58, 
Net change: 1250 -> 1732 = << 482 >>, blacklisted: 53. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -5.87e-18,  Y-C-I = -1.58e-11, Kgap = -2.26e-10) 

Evaluating 866 points to refine on ...
Mean level of abs(aH): 0.0397713. Maximum level of grid: 10. 
Nodes coarsened: 43, children added: 460, parents added: 70, 
Net change: 1732 -> 2219 = << 487 >>, blacklisted: 92. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -8.83e-19,  Y-C-I = -4.68e-11, Kgap = -6.70e-10) 

Evaluating 1036 points to refine on ...
Mean level of abs(aH): 0.0310543. Maximum level of grid: 11. 
Nodes coarsened: 92, children added: 452, parents added: 171, 
Net change: 2219 -> 2750 = << 531 >>, blacklisted: 173. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -1.20e-17,  Y-C-I = -1.53e-10, Kgap = -2.19e-09) 

L_inf norm |V_tpg1 - Vfine| = 2.79e+00  with # grid points: 165
L_inf norm |V_tpg2 - Vfine| = 1.35e+00  with # grid points: 585
L_inf norm |V_tpg3 - Vfine| = 6.38e-01  with # grid points: 2193
L_inf norm |V_tpg4 - Vfine| = 3.09e-01  with # grid points: 8481
L_inf norm |V_tpg5 - Vfine| = 1.45e-01  with # grid points: 33345
L_inf norm |V_tpg6 - Vfine| = 6.25e-02  with # grid points: 132225
L_inf norm |V_tpg7 - Vfine| = 2.08e-02  with # grid points: 526593
L_inf norm |V_sg1 - Vfine| = 2.79e+00  with # grid points: 165
L_inf norm |V_sg2 - Vfine| = 1.34e+00  with # grid points: 457
L_inf norm |V_sg3 - Vfine| = 6.12e-01  with # grid points: 1169
L_inf norm |V_sg4 - Vfine| = 2.83e-01  with # grid points: 2849
L_inf norm |V_sg5 - Vfine| = 1.22e-01  with # grid points: 6721
L_inf norm |V_sg6 - Vfine| = 4.59e-02  with # grid points: 15489
L_inf norm |V_sg7 - Vfine| = 1.32e-02  with # grid points: 35073


Algorithm converged. Run-time of: 1248.77 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.19),  markets(S = -2.85e-18,  Y-C-I = 6.05e-14, Kgap = 8.65e-13) 

Evaluating 146 points to refine on ...
Mean level of abs(aH): 0.419205. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 218, parents added: 0, 
Net change: 165 -> 383 = << 218 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = -4.79e-18,  Y-C-I = -1.28e-13, Kgap = -1.83e-12) 

Evaluating 309 points to refine on ...
Mean level of abs(aH): 0.1803. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 398, parents added: 0, 
Net change: 383 -> 780 = << 397 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = -7.14e-18,  Y-C-I = -5.93e-11, Kgap = -8.50e-10) 

Evaluating 502 points to refine on ...
Mean level of abs(aH): 0.0884116. Maximum level of grid: 8. 
Nodes coarsened: 25, children added: 479, parents added: 16, 
Net change: 780 -> 1250 = << 470 >>, blacklisted: 26. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -1.07e-17,  Y-C-I = 3.63e-12, Kgap = 5.20e-11) 

Evaluating 685 points to refine on ...
Mean level of abs(aH): 0.0551211. Maximum level of grid: 9. 
Nodes coarsened: 29, children added: 453, parents added: 58, 
Net change: 1250 -> 1732 = << 482 >>, blacklisted: 53. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -5.87e-18,  Y-C-I = -1.58e-11, Kgap = -2.26e-10) 

Evaluating 866 points to refine on ...
Mean level of abs(aH): 0.0397713. Maximum level of grid: 10. 
Nodes coarsened: 43, children added: 460, parents added: 70, 
Net change: 1732 -> 2219 = << 487 >>, blacklisted: 92. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -8.83e-19,  Y-C-I = -4.68e-11, Kgap = -6.70e-10) 

Evaluating 1036 points to refine on ...
Mean level of abs(aH): 0.0310543. Maximum level of grid: 11. 
Nodes coarsened: 92, children added: 452, parents added: 171, 
Net change: 2219 -> 2750 = << 531 >>, blacklisted: 173. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -1.20e-17,  Y-C-I = -1.53e-10, Kgap = -2.19e-09) 

<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',116,1)">116 </a>rng(1); P = 30000; points = rand(P, 2);
[~,G,GDense,ss] = stationary(X, G, GDense, param);
<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/HJB.m',41,1)">41  </a>end
figure; scatter3(G.a, G.z, IF)
{Unrecognized field name "a".
} 
figure; scatter3(G.k, G.z, IF)
figure; scatter3(G.k, G.z, I0)
figure; scatter3(G.k, G.z, IB)
figure; scatter3(G.k, G.z, IF)
if system_dependent('IsDebugMode')==1, dbquit; end
if system_dependent('IsDebugMode')==1, dbquit; end
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

if system_dependent('IsDebugMode')==1, dbcont; end
if system_dependent('IsDebugMode')==1, dbcont; end
Stationary Equilibrium: (r = 0.0184, K = 9.43),  markets(S = 3.64e-18,  Y-C-I = -1.17e-14, Kgap = -1.76e-13) 

Evaluating 133 points to refine on ...
Mean level of abs(aH): 0.520963. Maximum level of grid: 6. 
Nodes coarsened: 12, children added: 182, parents added: 0, 
Net change: 165 -> 335 = << 170 >>, blacklisted: 12. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0191, K = 9.29),  markets(S = 3.58e-18,  Y-C-I = -3.39e-14, Kgap = -4.85e-13) 

Evaluating 257 points to refine on ...
Mean level of abs(aH): 0.261835. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 299, parents added: 5, 
Net change: 335 -> 638 = << 303 >>, blacklisted: 13. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0194, K = 9.21),  markets(S = 3.05e-18,  Y-C-I = -1.09e-13, Kgap = -1.56e-12) 

Evaluating 433 points to refine on ...
Mean level of abs(aH): 0.139261. Maximum level of grid: 8. 
Nodes coarsened: 26, children added: 456, parents added: 3, 
Net change: 638 -> 1071 = << 433 >>, blacklisted: 36. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.18),  markets(S = 6.51e-18,  Y-C-I = 2.34e-12, Kgap = 3.35e-11) 

Evaluating 630 points to refine on ...
Mean level of abs(aH): 0.0836112. Maximum level of grid: 9. 
Nodes coarsened: 47, children added: 525, parents added: 34, 
Net change: 1071 -> 1583 = << 512 >>, blacklisted: 83. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = 7.54e-18,  Y-C-I = -8.48e-12, Kgap = -1.22e-10) 

Evaluating 833 points to refine on ...
Mean level of abs(aH): 0.0568675. Maximum level of grid: 10. 
Nodes coarsened: 90, children added: 528, parents added: 95, 
Net change: 1583 -> 2116 = << 533 >>, blacklisted: 170. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = 4.45e-18,  Y-C-I = -9.41e-11, Kgap = -1.35e-09) 

Evaluating 1021 points to refine on ...
Mean level of abs(aH): 0.0426985. Maximum level of grid: 11. 
Nodes coarsened: 164, children added: 512, parents added: 198, 
Net change: 2116 -> 2662 = << 546 >>, blacklisted: 293. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = 6.13e-18,  Y-C-I = 5.68e-11, Kgap = 8.14e-10) 

[~,G,GDense,ss] = stationary(X, G, GDense, param);
<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/HJB.m',41,1)">41  </a>end
figure; scatter3(G.k, G.z, IF)
if system_dependent('IsDebugMode')==1, dbquit; end
if system_dependent('IsDebugMode')==1, dbquit; end
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0177, K = 9.56),  markets(S = 7.34e-18,  Y-C-I = -3.93e-13, Kgap = -5.80e-12) 

Evaluating 100 points to refine on ...
Mean level of abs(aH): 0.674134. Maximum level of grid: 6. 
Nodes coarsened: 34, children added: 118, parents added: 2, 
Net change: 165 -> 251 = << 86 >>, blacklisted: 34. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0172, K = 9.67),  markets(S = 7.62e-18,  Y-C-I = 1.13e-14, Kgap = 1.69e-13) 

Evaluating 184 points to refine on ...
Mean level of abs(aH): 0.453848. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 230, parents added: 10, 
Net change: 251 -> 489 = << 238 >>, blacklisted: 36. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0182, K = 9.47),  markets(S = 4.31e-18,  Y-C-I = -1.04e-12, Kgap = -1.53e-11) 

Evaluating 305 points to refine on ...
Mean level of abs(aH): 0.242812. Maximum level of grid: 8. 
Nodes coarsened: 42, children added: 334, parents added: 25, 
Net change: 489 -> 806 = << 317 >>, blacklisted: 76. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0189, K = 9.32),  markets(S = 7.16e-18,  Y-C-I = -1.56e-13, Kgap = -2.26e-12) 

Evaluating 486 points to refine on ...
Mean level of abs(aH): 0.151957. Maximum level of grid: 9. 
Nodes coarsened: 76, children added: 508, parents added: 65, 
Net change: 806 -> 1303 = << 497 >>, blacklisted: 143. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0194, K = 9.23),  markets(S = 3.14e-18,  Y-C-I = 2.64e-12, Kgap = 3.81e-11) 

Evaluating 707 points to refine on ...
Mean level of abs(aH): 0.0959307. Maximum level of grid: 10. 
Nodes coarsened: 152, children added: 622, parents added: 139, 
Net change: 1303 -> 1912 = << 609 >>, blacklisted: 264. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0195, K = 9.20),  markets(S = 9.76e-19,  Y-C-I = -3.24e-11, Kgap = -4.66e-10) 

Evaluating 948 points to refine on ...
Mean level of abs(aH): 0.0661646. Maximum level of grid: 11. 
Nodes coarsened: 243, children added: 657, parents added: 216, 
Net change: 1912 -> 2542 = << 630 >>, blacklisted: 423. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.19),  markets(S = 1.73e-18,  Y-C-I = -1.00e-10, Kgap = -1.44e-09) 

[~,G,GDense,ss] = stationary(X, G, GDense, param);
<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/HJB.m',41,1)">41  </a>end
figure; scatter3(G.k, G.z, IF)
if system_dependent('IsDebugMode')==1, dbquit; end
figure; scatter3(G.k, G.z, ss.c)
if system_dependent('IsDebugMode')==1, dbquit; end
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/HJB.m',41,1)">41  </a>end
if system_dependent('IsDebugMode')==1, dbcont; end
Stationary Equilibrium: (r = 0.0196, K = 9.19),  markets(S = -2.85e-18,  Y-C-I = 6.05e-14, Kgap = 8.65e-13) 

Evaluating 146 points to refine on ...
Mean level of abs(aH): 0.419205. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 218, parents added: 0, 
Net change: 165 -> 383 = << 218 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = -4.79e-18,  Y-C-I = -1.28e-13, Kgap = -1.83e-12) 

Evaluating 309 points to refine on ...
Mean level of abs(aH): 0.1803. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 398, parents added: 0, 
Net change: 383 -> 780 = << 397 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = -7.14e-18,  Y-C-I = -5.93e-11, Kgap = -8.50e-10) 

Evaluating 502 points to refine on ...
Mean level of abs(aH): 0.0884116. Maximum level of grid: 8. 
Nodes coarsened: 25, children added: 479, parents added: 16, 
Net change: 780 -> 1250 = << 470 >>, blacklisted: 26. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -1.07e-17,  Y-C-I = 3.63e-12, Kgap = 5.20e-11) 

Evaluating 685 points to refine on ...
Mean level of abs(aH): 0.0551211. Maximum level of grid: 9. 
Nodes coarsened: 29, children added: 453, parents added: 58, 
Net change: 1250 -> 1732 = << 482 >>, blacklisted: 53. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -5.87e-18,  Y-C-I = -1.58e-11, Kgap = -2.26e-10) 

Evaluating 866 points to refine on ...
Mean level of abs(aH): 0.0397713. Maximum level of grid: 10. 
Nodes coarsened: 43, children added: 460, parents added: 70, 
Net change: 1732 -> 2219 = << 487 >>, blacklisted: 92. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -8.83e-19,  Y-C-I = -4.68e-11, Kgap = -6.70e-10) 

Evaluating 1036 points to refine on ...
Mean level of abs(aH): 0.0310543. Maximum level of grid: 11. 
Nodes coarsened: 92, children added: 452, parents added: 171, 
Net change: 2219 -> 2750 = << 531 >>, blacklisted: 173. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -1.20e-17,  Y-C-I = -1.53e-10, Kgap = -2.19e-09) 

figure; scatter3(GDense.k, GDense.z, ss.g)
if system_dependent('IsDebugMode')==1, dbquit all; end
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0195, K = 9.20),  markets(S = -2.49e-16,  Y-C-I = -1.39e-13, Kgap = -2.02e-12) 

Evaluating 146 points to refine on ...
Mean level of abs(aH): 0.418974. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 218, parents added: 0, 
Net change: 165 -> 383 = << 218 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = -2.30e-16,  Y-C-I = 6.26e-14, Kgap = 9.18e-13) 

Evaluating 309 points to refine on ...
Mean level of abs(aH): 0.180346. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 398, parents added: 0, 
Net change: 383 -> 780 = << 397 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -3.04e-16,  Y-C-I = 1.22e-12, Kgap = 1.74e-11) 

Evaluating 502 points to refine on ...
Mean level of abs(aH): 0.0884441. Maximum level of grid: 8. 
Nodes coarsened: 25, children added: 478, parents added: 16, 
Net change: 780 -> 1249 = << 469 >>, blacklisted: 26. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0199, K = 9.13),  markets(S = -2.60e-16,  Y-C-I = -4.36e-12, Kgap = -6.24e-11) 

Evaluating 682 points to refine on ...
Mean level of abs(aH): 0.0551846. Maximum level of grid: 9. 
Nodes coarsened: 31, children added: 449, parents added: 57, 
Net change: 1249 -> 1724 = << 475 >>, blacklisted: 56. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0199, K = 9.13),  markets(S = -2.37e-16,  Y-C-I = -4.06e-11, Kgap = -5.81e-10) 

Evaluating 866 points to refine on ...
Mean level of abs(aH): 0.0399693. Maximum level of grid: 10. 
Nodes coarsened: 42, children added: 461, parents added: 72, 
Net change: 1724 -> 2215 = << 491 >>, blacklisted: 93. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0199, K = 9.13),  markets(S = -2.21e-16,  Y-C-I = 1.32e-10, Kgap = 1.89e-09) 

Evaluating 1036 points to refine on ...
Mean level of abs(aH): 0.0311213. Maximum level of grid: 11. 
Nodes coarsened: 91, children added: 455, parents added: 171, 
Net change: 2215 -> 2750 = << 535 >>, blacklisted: 172. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0199, K = 9.13),  markets(S = -2.46e-16,  Y-C-I = -1.53e-10, Kgap = -2.19e-09) 

figure; scatter3(GDense.k, GDense.z, ss.g)
if system_dependent('IsDebugMode')==1, dbquit all; end
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0171, K = 9.70),  markets(S = 6.45e-18,  Y-C-I = -2.24e-10, Kgap = -3.33e-09) 

Evaluating 117 points to refine on ...
Mean level of abs(aH): 0.589803. Maximum level of grid: 6. 
Nodes coarsened: 23, children added: 146, parents added: 0, 
Net change: 165 -> 288 = << 123 >>, blacklisted: 23. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0181, K = 9.48),  markets(S = 3.31e-18,  Y-C-I = -3.89e-14, Kgap = -5.67e-13) 

Evaluating 218 points to refine on ...
Mean level of abs(aH): 0.351686. Maximum level of grid: 7. 
Nodes coarsened: 4, children added: 258, parents added: 7, 
Net change: 288 -> 549 = << 261 >>, blacklisted: 27. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0189, K = 9.32),  markets(S = 8.51e-18,  Y-C-I = 2.69e-14, Kgap = 3.87e-13) 

Evaluating 352 points to refine on ...
Mean level of abs(aH): 0.190114. Maximum level of grid: 8. 
Nodes coarsened: 28, children added: 367, parents added: 16, 
Net change: 549 -> 904 = << 355 >>, blacklisted: 52. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0194, K = 9.23),  markets(S = 5.85e-18,  Y-C-I = 2.16e-12, Kgap = 3.11e-11) 

Evaluating 549 points to refine on ...
Mean level of abs(aH): 0.11774. Maximum level of grid: 9. 
Nodes coarsened: 66, children added: 539, parents added: 50, 
Net change: 904 -> 1427 = << 523 >>, blacklisted: 114. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.19),  markets(S = 1.25e-18,  Y-C-I = 9.25e-12, Kgap = 1.33e-10) 

Evaluating 777 points to refine on ...
Mean level of abs(aH): 0.075489. Maximum level of grid: 10. 
Nodes coarsened: 117, children added: 614, parents added: 122, 
Net change: 1427 -> 2046 = << 619 >>, blacklisted: 214. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.17),  markets(S = 5.85e-18,  Y-C-I = 2.02e-11, Kgap = 2.90e-10) 

Evaluating 998 points to refine on ...
Mean level of abs(aH): 0.0530336. Maximum level of grid: 11. 
Nodes coarsened: 228, children added: 590, parents added: 204, 
Net change: 2046 -> 2612 = << 566 >>, blacklisted: 374. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = 3.47e-18,  Y-C-I = -2.50e-11, Kgap = -3.59e-10) 

Evaluating 1127 points to refine on ...
Mean level of abs(aH): 0.0417299. Maximum level of grid: 12. 
Nodes coarsened: 295, children added: 339, parents added: 200, 
Net change: 2612 -> 2856 = << 244 >>, blacklisted: 528. 


 -------  GRID ADAPTATION ITERATION 8  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = 1.73e-18,  Y-C-I = -4.44e-11, Kgap = -6.38e-10) 

<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',116,1)">116 </a>rng(1); P = 30000; points = rand(P, 2);
figure; scatter3(G.k, G.z, ss.c)
[~,G,GDense,ss] = stationary(X, G, GDense, param);
<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/HJB.m',41,1)">41  </a>end
figure; scatter3(G.k, G.z, IF)
if system_dependent('IsDebugMode')==1, dbquit; end
figure; scatter3(GDense.k, GDense.z, ss.g)
figure; scatter3(G.k, G.z, ss.c)
if system_dependent('IsDebugMode')==1, dbquit; end
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

if system_dependent('IsDebugMode')==1, dbcont; end
Stationary Equilibrium: (r = 0.0193, K = 9.24),  markets(S = 2.39e-18,  Y-C-I = 3.84e-14, Kgap = 5.49e-13) 

Evaluating 141 points to refine on ...
Mean level of abs(aH): 0.452643. Maximum level of grid: 6. 
Nodes coarsened: 1, children added: 206, parents added: 1, 
Net change: 165 -> 371 = << 206 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.19),  markets(S = 3.24e-18,  Y-C-I = 1.28e-13, Kgap = 1.85e-12) 

Evaluating 293 points to refine on ...
Mean level of abs(aH): 0.20207. Maximum level of grid: 7. 
Nodes coarsened: 2, children added: 369, parents added: 1, 
Net change: 371 -> 739 = << 368 >>, blacklisted: 3. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = 5.69e-18,  Y-C-I = 1.91e-13, Kgap = 2.74e-12) 

Evaluating 488 points to refine on ...
Mean level of abs(aH): 0.101564. Maximum level of grid: 8. 
Nodes coarsened: 29, children added: 482, parents added: 3, 
Net change: 739 -> 1195 = << 456 >>, blacklisted: 32. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = 7.96e-18,  Y-C-I = -1.47e-12, Kgap = -2.11e-11) 

Evaluating 673 points to refine on ...
Mean level of abs(aH): 0.0628531. Maximum level of grid: 9. 
Nodes coarsened: 38, children added: 458, parents added: 13, 
Net change: 1195 -> 1628 = << 433 >>, blacklisted: 70. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = 3.11e-18,  Y-C-I = -2.90e-11, Kgap = -4.16e-10) 

Evaluating 841 points to refine on ...
Mean level of abs(aH): 0.0461698. Maximum level of grid: 10. 
Nodes coarsened: 30, children added: 438, parents added: 102, 
Net change: 1628 -> 2138 = << 510 >>, blacklisted: 98. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = 9.99e-18,  Y-C-I = -8.02e-11, Kgap = -1.15e-09) 

Evaluating 1019 points to refine on ...
Mean level of abs(aH): 0.0351934. Maximum level of grid: 11. 
Nodes coarsened: 70, children added: 478, parents added: 140, 
Net change: 2138 -> 2686 = << 548 >>, blacklisted: 160. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = 7.19e-18,  Y-C-I = -5.31e-11, Kgap = -7.60e-10) 

Evaluating 1128 points to refine on ...
Mean level of abs(aH): 0.028037. Maximum level of grid: 12. 
Nodes coarsened: 194, children added: 282, parents added: 213, 
Net change: 2686 -> 2987 = << 301 >>, blacklisted: 320. 


 -------  GRID ADAPTATION ITERATION 8  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = 2.79e-18,  Y-C-I = -4.24e-11, Kgap = -6.07e-10) 

figure; scatter3(G.k, G.z, ss.c)
if system_dependent('IsDebugMode')==1, dbquit; end
figure; scatter3(GDense.k, GDense.z, ss.g)
figure; scatter3(G.k, G.z, ss.c)
figure; scatter3(GDense.k, GDense.z, ss.g)
format long
ss.r

ans =

   0.019799574265530

main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.19),  markets(S = -2.85e-18,  Y-C-I = 6.05e-14, Kgap = 8.65e-13) 

Evaluating 146 points to refine on ...
Mean level of abs(aH): 0.419205. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 218, parents added: 0, 
Net change: 165 -> 383 = << 218 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.16),  markets(S = -4.79e-18,  Y-C-I = -1.28e-13, Kgap = -1.83e-12) 

Evaluating 309 points to refine on ...
Mean level of abs(aH): 0.1803. Maximum level of grid: 7. 
Nodes coarsened: 1, children added: 398, parents added: 0, 
Net change: 383 -> 780 = << 397 >>, blacklisted: 1. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.15),  markets(S = -7.14e-18,  Y-C-I = -5.93e-11, Kgap = -8.50e-10) 

Evaluating 502 points to refine on ...
Mean level of abs(aH): 0.0884116. Maximum level of grid: 8. 
Nodes coarsened: 25, children added: 479, parents added: 16, 
Net change: 780 -> 1250 = << 470 >>, blacklisted: 26. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -1.07e-17,  Y-C-I = 3.63e-12, Kgap = 5.20e-11) 

Evaluating 685 points to refine on ...
Mean level of abs(aH): 0.0551211. Maximum level of grid: 9. 
Nodes coarsened: 29, children added: 453, parents added: 58, 
Net change: 1250 -> 1732 = << 482 >>, blacklisted: 53. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -5.87e-18,  Y-C-I = -1.58e-11, Kgap = -2.26e-10) 

Evaluating 866 points to refine on ...
Mean level of abs(aH): 0.0397713. Maximum level of grid: 10. 
Nodes coarsened: 43, children added: 460, parents added: 70, 
Net change: 1732 -> 2219 = << 487 >>, blacklisted: 92. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -8.83e-19,  Y-C-I = -4.68e-11, Kgap = -6.70e-10) 

Evaluating 1036 points to refine on ...
Mean level of abs(aH): 0.0310543. Maximum level of grid: 11. 
Nodes coarsened: 92, children added: 452, parents added: 171, 
Net change: 2219 -> 2750 = << 531 >>, blacklisted: 173. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -1.20e-17,  Y-C-I = -1.53e-10, Kgap = -2.19e-09) 

Evaluating 1133 points to refine on ...
Mean level of abs(aH): 0.0250687. Maximum level of grid: 12. 
Nodes coarsened: 218, children added: 274, parents added: 255, 
Net change: 2750 -> 3061 = << 311 >>, blacklisted: 323. 


 -------  GRID ADAPTATION ITERATION 8  ------- 

Stationary Equilibrium: (r = 0.0198, K = 9.14),  markets(S = -8.73e-18,  Y-C-I = 1.66e-10, Kgap = 2.38e-09) 

<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',116,1)">116 </a>rng(1); P = 30000; points = rand(P, 2);
ss.r

ans =

   0.019842539148143

if system_dependent('IsDebugMode')==1, dbquit all; end
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0195, K = 9.21),  markets(S = -3.09e-18,  Y-C-I = 4.33e-01, Kgap = 2.22e-03) 

Evaluating 18 points to refine on ...
Mean level of abs(aH): 537.084. Maximum level of grid: 5. 
Nodes coarsened: 116, children added: 14, parents added: 5, 
Net change: 165 -> 68 = << -97 >>, blacklisted: 116. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0195, K = 9.20),  markets(S = -1.82e-17,  Y-C-I = 5.62e-01, Kgap = 1.86e+00) 

Evaluating 56 points to refine on ...
Mean level of abs(aH): 1118.73. Maximum level of grid: 6. 
Nodes coarsened: 3, children added: 54, parents added: 3, 
Net change: 68 -> 122 = << 54 >>, blacklisted: 118. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0192, K = 9.27),  markets(S = 9.93e-18,  Y-C-I = 1.23e-13, Kgap = 1.78e-12) 

Evaluating 122 points to refine on ...
Mean level of abs(aH): 0.549513. Maximum level of grid: 7. 
Nodes coarsened: 0, children added: 142, parents added: 16, 
Net change: 122 -> 280 = << 158 >>, blacklisted: 118. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0193, K = 9.25),  markets(S = -3.50e-18,  Y-C-I = 3.79e-13, Kgap = 5.46e-12) 

Evaluating 275 points to refine on ...
Mean level of abs(aH): 0.240151. Maximum level of grid: 8. 
Nodes coarsened: 2, children added: 345, parents added: 33, 
Net change: 280 -> 656 = << 376 >>, blacklisted: 120. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0195, K = 9.21),  markets(S = 4.76e-18,  Y-C-I = -1.34e-13, Kgap = -1.92e-12) 

Evaluating 546 points to refine on ...
Mean level of abs(aH): 0.10326. Maximum level of grid: 9. 
Nodes coarsened: 5, children added: 631, parents added: 55, 
Net change: 656 -> 1337 = << 681 >>, blacklisted: 124. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0195, K = 9.20),  markets(S = 1.79e-17,  Y-C-I = -6.34e-12, Kgap = -9.11e-11) 

Evaluating 835 points to refine on ...
Mean level of abs(aH): 0.0509849. Maximum level of grid: 10. 
Nodes coarsened: 23, children added: 705, parents added: 151, 
Net change: 1337 -> 2170 = << 833 >>, blacklisted: 146. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0196, K = 9.18),  markets(S = 1.47e-17,  Y-C-I = 2.43e-11, Kgap = 3.48e-10) 

Evaluating 1050 points to refine on ...
Mean level of abs(aH): 0.0315646. Maximum level of grid: 11. 
Nodes coarsened: 168, children added: 540, parents added: 246, 
Net change: 2170 -> 2788 = << 618 >>, blacklisted: 308. 


 -------  GRID ADAPTATION ITERATION 8  ------- 

Stationary Equilibrium: (r = 0.0197, K = 9.17),  markets(S = 8.77e-19,  Y-C-I = -1.01e-10, Kgap = -1.45e-09) 

ss.r

ans =

   0.019665338538256

if system_dependent('IsDebugMode')==1, dbquit all; end
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0187, K = 9.37),  markets(S = -2.34e-18,  Y-C-I = -9.48e-14, Kgap = -1.38e-12) 

Evaluating 148 points to refine on ...
Mean level of abs(aH): 0.441396. Maximum level of grid: 6. 
Nodes coarsened: 2, children added: 230, parents added: 2, 
Net change: 165 -> 395 = << 230 >>, blacklisted: 2. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0190, K = 9.30),  markets(S = -7.80e-18,  Y-C-I = -1.11e-14, Kgap = -1.56e-13) 

Evaluating 309 points to refine on ...
Mean level of abs(aH): 0.18463. Maximum level of grid: 7. 
Nodes coarsened: 3, children added: 384, parents added: 14, 
Net change: 395 -> 790 = << 395 >>, blacklisted: 5. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0192, K = 9.26),  markets(S = -1.35e-17,  Y-C-I = -4.80e-11, Kgap = -6.93e-10) 

Evaluating 519 points to refine on ...
Mean level of abs(aH): 0.0921391. Maximum level of grid: 8. 
Nodes coarsened: 21, children added: 507, parents added: 10, 
Net change: 790 -> 1286 = << 496 >>, blacklisted: 25. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0193, K = 9.24),  markets(S = -3.43e-18,  Y-C-I = 2.58e-14, Kgap = 3.77e-13) 

Evaluating 723 points to refine on ...
Mean level of abs(aH): 0.0565797. Maximum level of grid: 9. 
Nodes coarsened: 32, children added: 495, parents added: 25, 
Net change: 1286 -> 1774 = << 488 >>, blacklisted: 55. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0193, K = 9.24),  markets(S = 6.16e-18,  Y-C-I = -1.30e-11, Kgap = -1.87e-10) 

Evaluating 917 points to refine on ...
Mean level of abs(aH): 0.0410838. Maximum level of grid: 10. 
Nodes coarsened: 30, children added: 499, parents added: 133, 
Net change: 1774 -> 2376 = << 602 >>, blacklisted: 78. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0194, K = 9.23),  markets(S = 6.05e-18,  Y-C-I = 1.07e-11, Kgap = 1.55e-10) 

Evaluating 1105 points to refine on ...
Mean level of abs(aH): 0.0307334. Maximum level of grid: 11. 
Nodes coarsened: 81, children added: 512, parents added: 159, 
Net change: 2376 -> 2966 = << 590 >>, blacklisted: 143. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0194, K = 9.23),  markets(S = 4.50e-18,  Y-C-I = -3.22e-11, Kgap = -4.65e-10) 

L_inf norm |V_tpg1 - Vfine| = 3.02e+00  with # grid points: 165
L_inf norm |V_tpg2 - Vfine| = 1.49e+00  with # grid points: 585
L_inf norm |V_tpg3 - Vfine| = 7.01e-01  with # grid points: 2193
L_inf norm |V_tpg4 - Vfine| = 3.42e-01  with # grid points: 8481
L_inf norm |V_tpg5 - Vfine| = 1.61e-01  with # grid points: 33345
L_inf norm |V_tpg6 - Vfine| = 6.96e-02  with # grid points: 132225
L_inf norm |V_tpg7 - Vfine| = 2.32e-02  with # grid points: 526593
L_inf norm |V_sg1 - Vfine| = 3.02e+00  with # grid points: 165
L_inf norm |V_sg2 - Vfine| = 1.47e+00  with # grid points: 457
L_inf norm |V_sg3 - Vfine| = 6.51e-01  with # grid points: 1169
L_inf norm |V_sg4 - Vfine| = 2.91e-01  with # grid points: 2849
VFI did not converge. Remaining Gap: 100
VFI did not converge. Remaining Gap: 3.50e+04
{Unable to perform assignment because the size of the left side is 1-by-1 and the size of the right side is 1-by-6721.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('sparseProject', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m', 10)" style="font-weight:bold">sparseProject</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/lib/grid/sparseProject.m',10,0)">line 10</a>)
        xProject(i, :) = BH * xH;

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m', 164)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',164,0)">line 164</a>)
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
} 
param.maxit = 2000;
param.Delta = 0.5;
opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',164,0)
opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/main.m',164,0)
for j = 1:param.fineLevel %+2
    
    GSG{j} = setup_grid(j-1, param.surplus, param.min, param.max, 'named_dims', {1,2}, 'names', {'k','z'}, 'dxx_dims', 2);
    GSG{j}.BHDense = get_projection_matrix(GDense.grid, GDense.lvl, GSG{j});
    
    [~,~,~,ssSG{j}] = stationary([ss.K, ss.tau], GSG{j}, GDense, param);
    
    Vtest = zeros(P,1);
    for k = 1:P
        Vtest(k) = sparseProject(ssSG{j}.V, points(k,:), GSG{j});
    end
    GSG{j}.Vtest = Vtest;
    GSG{j}.normInf = norm(GSG{j}.Vtest - GFine.Vtest, Inf);

    fprintf('L_inf norm |V_sg%.i - Vfine| = %.2d  with # grid points: %.i\n', ...
        j, GSG{j}.normInf, GSG{j}.J);

end
L_inf norm |V_sg1 - Vfine| = 3.02e+00  with # grid points: 165
L_inf norm |V_sg2 - Vfine| = 1.47e+00  with # grid points: 457
L_inf norm |V_sg3 - Vfine| = 6.51e-01  with # grid points: 1169
L_inf norm |V_sg4 - Vfine| = 2.91e-01  with # grid points: 2849
L_inf norm |V_sg5 - Vfine| = 1.19e-01  with # grid points: 6721
L_inf norm |V_sg6 - Vfine| = 4.14e-02  with # grid points: 15489
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m', 24)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/VFI.m',24,0)">line 24</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m', 33)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/ASG/schaabzhang/use_cases/04_aiyagari_transition_dynamics/01f_handbook_output/stationary.m',33,0)">line 33</a>)
[V, hjb] = VFI(G, [], param);
} 
% Adaptive sparse grids:
for j = 1:adaptIter
    
    [~,~,~,ssASG{j}] = stationary([ss.K, ss.tau], G_adapt{j}, GDense, param);

    Vtest = zeros(P,1);
    for k = 1:P
        Vtest(k) = sparseProject(ssASG{j}.V, points(k,:), G_adapt{j});
    end
    G_adapt{j}.Vtest = Vtest;
    G_adapt{j}.normInf = norm(G_adapt{j}.Vtest - GFine.Vtest, Inf);
    
end


% Plot:
normASG=[];normSG=[];normTPG=[]; gridPointsASG=[];gridPointsSG=[];gridPointsTPG=[];
for j = 1:max([numel(G_adapt),numel(GSG),numel(GTPG)]) %param.fineLevel-1
    if j>numel(G_adapt)
        continue;
    else
        normASG(j) = G_adapt{j}.normInf;
        gridPointsASG(j) = G_adapt{j}.J;
    end
    
    if j>numel(GSG)
        continue;
    else
        normSG(j)  = GSG{j}.normInf;
        gridPointsSG(j)  = GSG{j}.J;
    end
    
    if j>numel(GTPG)
        continue;
    else
        normTPG(j) = GTPG{j}.normInf;
        gridPointsTPG(j) = GTPG{j}.J;
    end    
end
{Unrecognized field name "normInf".
} 
runTime = toc(runTime); fprintf('\n\nAlgorithm converged. Run-time of: %.2f seconds.\n',runTime);


Algorithm converged. Run-time of: 2154.33 seconds.

fprintf('\nPlotting Figures...\n');

Plotting Figures...
for n = 1:adaptIter
    
    figure('visible', 'off');
    subplot(1,2,1);
    l1=scatter3(G_adapt{n}.k, G_adapt{n}.z, V_adapt{n});
    xlabel('Capital: $k$','Interpreter','Latex');
        xlh = get(gca,'xlabel'); gxl = get(xlh); xlp = get(xlh, 'Position');
        set(xlh,'Rotation', 16,'Position',xlp,'VerticalAlignment','middle','HorizontalAlignment','left');
    ylabel('Earnings: $z$','Interpreter','Latex');
        ylh = get(gca,'ylabel'); gyl = get(ylh); ylp = get(ylh, 'Position');
        set(ylh,'Rotation',-27,'Position',ylp,'VerticalAlignment','middle','HorizontalAlignment','right');
    title('$V(a,z)$','Interpreter','Latex');
        
    subplot(1,2,2);
    l1=scatter3(G_adapt{n}.k, G_adapt{n}.z, c_adapt{n});
    xlabel('Capital: $k$','Interpreter','Latex');
        xlh = get(gca,'xlabel'); gxl = get(xlh); xlp = get(xlh, 'Position');
        set(xlh,'Rotation', 16,'Position',xlp,'VerticalAlignment','middle','HorizontalAlignment','left');
    ylabel('Earnings: $z$','Interpreter','Latex');
        ylh = get(gca,'ylabel'); gyl = get(ylh); ylp = get(ylh, 'Position');
        set(ylh,'Rotation',-27,'Position',ylp,'VerticalAlignment','middle','HorizontalAlignment','right');
    title('$c(a,z)$','Interpreter','Latex');
    
    set(gcf,'renderer','Painters', 'Position', [10 10 1200 400]);
    exportgraphics(gcf, ['./output/grid_adaptation', num2str(n-1), '.eps']);

end

figure('visible', 'off');
subplot(1,2,1); hold on;
l1 = plot(1:numel(normASG), normASG);
l2 = plot(1:numel(normSG), normSG);
l3 = plot(1:numel(normTPG), normTPG);
hold off; title('$L_\infty$ norm','Interpreter','Latex');
xlabel('Grid levels / adaptations');
legend([l1,l2,l3],{'Adaptive Sparse Grid', 'Regular Sparse Grid', 'Uniform Dense Grid'}, 'box', 'off');

subplot(1,2,2); hold on;
l1 = plot(1:numel(gridPointsASG), gridPointsASG);
l2 = plot(1:numel(gridPointsSG), gridPointsSG);
l3 = plot(1:numel(gridPointsTPG), gridPointsTPG);
hold off; title('Grid points','Interpreter','Latex');
xlabel('Grid levels / adaptations');
    
set(gcf,'renderer','Painters');
exportgraphics(gcf, './output/error1.eps');


figure('visible', 'off'); hold on;
l1 = plot(gridPointsASG, normASG); 
l2 = plot(gridPointsSG,  normSG);
l3 = plot(gridPointsTPG, normTPG);
hold off;
xlabel('Grid points'); 
title('$L_\infty$ norm','Interpreter','Latex');
set(gca, 'XScale','log', 'YScale','log');
    
legend([l1,l2,l3],{'Adaptive Sparse Grid', 'Regular Sparse Grid', 'Uniform Dense Grid'}, 'box', 'off');
set(gcf,'renderer','Painters');
exportgraphics(gcf, './output/error2.eps');

diary off
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: (r = 0.0187, K = 9.37),  markets(S = -5.58e-18,  Y-C-I = 5.16e-15, Kgap = 6.39e-14) 

Evaluating 145 points to refine on ...
Mean level of abs(aH): 0.441863. Maximum level of grid: 6. 
Nodes coarsened: 0, children added: 216, parents added: 0, 
Net change: 165 -> 381 = << 216 >>, blacklisted: 0. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: (r = 0.0190, K = 9.30),  markets(S = 1.97e-17,  Y-C-I = 8.27e-14, Kgap = 1.19e-12) 

Evaluating 299 points to refine on ...
Mean level of abs(aH): 0.191263. Maximum level of grid: 7. 
Nodes coarsened: 3, children added: 380, parents added: 0, 
Net change: 381 -> 758 = << 377 >>, blacklisted: 3. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: (r = 0.0192, K = 9.26),  markets(S = 2.03e-18,  Y-C-I = -1.00e-10, Kgap = -1.45e-09) 

Evaluating 513 points to refine on ...
Mean level of abs(aH): 0.0959477. Maximum level of grid: 8. 
Nodes coarsened: 26, children added: 507, parents added: 4, 
Net change: 758 -> 1243 = << 485 >>, blacklisted: 29. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: (r = 0.0193, K = 9.25),  markets(S = 1.93e-17,  Y-C-I = 1.97e-13, Kgap = 2.84e-12) 

Evaluating 700 points to refine on ...
Mean level of abs(aH): 0.0584937. Maximum level of grid: 9. 
Nodes coarsened: 19, children added: 460, parents added: 21, 
Net change: 1243 -> 1705 = << 462 >>, blacklisted: 48. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: (r = 0.0193, K = 9.24),  markets(S = 1.59e-17,  Y-C-I = 1.13e-11, Kgap = 1.64e-10) 

Evaluating 879 points to refine on ...
Mean level of abs(aH): 0.0427117. Maximum level of grid: 10. 
Nodes coarsened: 31, children added: 466, parents added: 114, 
Net change: 1705 -> 2254 = << 549 >>, blacklisted: 76. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: (r = 0.0193, K = 9.24),  markets(S = -3.75e-18,  Y-C-I = -2.25e-11, Kgap = -3.24e-10) 

Evaluating 1066 points to refine on ...
Mean level of abs(aH): 0.0323685. Maximum level of grid: 11. 
Nodes coarsened: 60, children added: 499, parents added: 147, 
Net change: 2254 -> 2840 = << 586 >>, blacklisted: 126. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: (r = 0.0193, K = 9.24),  markets(S = 1.88e-17,  Y-C-I = -2.32e-12, Kgap = -3.35e-11) 

L_inf norm |V_tpg1 - Vfine| = 3.02e+00  with # grid points: 165
L_inf norm |V_tpg2 - Vfine| = 1.49e+00  with # grid points: 585
L_inf norm |V_tpg3 - Vfine| = 7.01e-01  with # grid points: 2193
L_inf norm |V_tpg4 - Vfine| = 3.42e-01  with # grid points: 8481
L_inf norm |V_tpg5 - Vfine| = 1.61e-01  with # grid points: 33345
L_inf norm |V_tpg6 - Vfine| = 6.96e-02  with # grid points: 132225
L_inf norm |V_tpg7 - Vfine| = 2.32e-02  with # grid points: 526593
L_inf norm |V_sg1 - Vfine| = 3.02e+00  with # grid points: 165
L_inf norm |V_sg2 - Vfine| = 1.47e+00  with # grid points: 457
L_inf norm |V_sg3 - Vfine| = 6.51e-01  with # grid points: 1169
L_inf norm |V_sg4 - Vfine| = 2.91e-01  with # grid points: 2849
L_inf norm |V_sg5 - Vfine| = 1.19e-01  with # grid points: 6721
L_inf norm |V_sg6 - Vfine| = 4.14e-02  with # grid points: 15489
L_inf norm |V_sg7 - Vfine| = 1.05e-02  with # grid points: 35073


Algorithm converged. Run-time of: 1271.98 seconds.

Plotting Figures...
