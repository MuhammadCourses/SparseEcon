Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

Stationary Equilibrium: [r=0.0151  K=6.75]  Markets: [S=4.39e-08  B=-5.47e-14  Y-C-I=1.71e-13  K-KS=-1.97e-06] 

Evaluating 244 points to refine on ...
Mean level of abs(aH): 0.0699764. Maximum level of grid: 11. 
Nodes coarsened: 517, children added: 98, parents added: 0, 
Net change: 1025 -> 606 = << -419 >>, blacklisted: 517. 


 -------  GRID ADAPTATION ITERATION 2  ------- 

Stationary Equilibrium: [r=0.0170  K=6.55]  Markets: [S=9.52e-10  B=-1.57e-12  Y-C-I=6.30e-13  K-KS=-3.96e-08] 

Evaluating 291 points to refine on ...
Mean level of abs(aH): 0.118427. Maximum level of grid: 12. 
Nodes coarsened: 0, children added: 94, parents added: 0, 
Net change: 606 -> 700 = << 94 >>, blacklisted: 517. 


 -------  GRID ADAPTATION ITERATION 3  ------- 

Stationary Equilibrium: [r=0.0180  K=6.44]  Markets: [S=1.01e-09  B=2.25e-12  Y-C-I=-2.63e-13  K-KS=-4.03e-08] 

Evaluating 335 points to refine on ...
Mean level of abs(aH): 0.102569. Maximum level of grid: 13. 
Nodes coarsened: 0, children added: 88, parents added: 0, 
Net change: 700 -> 788 = << 88 >>, blacklisted: 517. 


 -------  GRID ADAPTATION ITERATION 4  ------- 

Stationary Equilibrium: [r=0.0186  K=6.38]  Markets: [S=1.04e-09  B=2.34e-10  Y-C-I=-9.17e-12  K-KS=-4.11e-08] 

Evaluating 375 points to refine on ...
Mean level of abs(aH): 0.0911833. Maximum level of grid: 14. 
Nodes coarsened: 0, children added: 80, parents added: 0, 
Net change: 788 -> 868 = << 80 >>, blacklisted: 517. 


 -------  GRID ADAPTATION ITERATION 5  ------- 

Stationary Equilibrium: [r=0.0189  K=6.35]  Markets: [S=1.08e-09  B=4.34e-11  Y-C-I=-5.32e-13  K-KS=-4.18e-08] 

Evaluating 410 points to refine on ...
Mean level of abs(aH): 0.0828052. Maximum level of grid: 15. 
Nodes coarsened: 0, children added: 70, parents added: 0, 
Net change: 868 -> 938 = << 70 >>, blacklisted: 517. 


 -------  GRID ADAPTATION ITERATION 6  ------- 

Stationary Equilibrium: [r=0.0190  K=6.34]  Markets: [S=1.09e-09  B=-7.58e-12  Y-C-I=-9.20e-14  K-KS=-4.21e-08] 

Evaluating 437 points to refine on ...
Mean level of abs(aH): 0.0766273. Maximum level of grid: 16. 
Nodes coarsened: 0, children added: 54, parents added: 0, 
Net change: 938 -> 992 = << 54 >>, blacklisted: 517. 


 -------  GRID ADAPTATION ITERATION 7  ------- 

Stationary Equilibrium: [r=0.0191  K=6.34]  Markets: [S=1.09e-09  B=4.61e-12  Y-C-I=-2.88e-13  K-KS=-4.22e-08] 

Evaluating 455 points to refine on ...
Mean level of abs(aH): 0.0724592. Maximum level of grid: 17. 
Nodes coarsened: 0, children added: 36, parents added: 0, 
Net change: 992 -> 1028 = << 36 >>, blacklisted: 517. 


 -------  GRID ADAPTATION ITERATION 8  ------- 

Stationary Equilibrium: [r=0.0191  K=6.34]  Markets: [S=1.09e-09  B=2.83e-10  Y-C-I=7.78e-12  K-KS=-4.17e-08] 

Evaluating 463 points to refine on ...
Mean level of abs(aH): 0.0699266. Maximum level of grid: 18. 
Nodes coarsened: 0, children added: 16, parents added: 0, 
Net change: 1028 -> 1044 = << 16 >>, blacklisted: 517. 


 -------  GRID ADAPTATION ITERATION 9  ------- 

Stationary Equilibrium: [r=0.0191  K=6.34]  Markets: [S=1.09e-09  B=5.32e-10  Y-C-I=5.53e-12  K-KS=-4.17e-08] 

Evaluating 465 points to refine on ...
Mean level of abs(aH): 0.0688582. Maximum level of grid: 19. 
Nodes coarsened: 0, children added: 4, parents added: 0, 
Net change: 1044 -> 1048 = << 4 >>, blacklisted: 517. 


 -------  GRID ADAPTATION ITERATION 10  ------- 

Stationary Equilibrium: [r=0.0191  K=6.34]  Markets: [S=1.09e-09  B=-2.62e-11  Y-C-I=6.84e-13  K-KS=-4.23e-08] 

Evaluating 465 points to refine on ...
Mean level of abs(aH): 0.0685965. Maximum level of grid: 19. 
Nodes coarsened: 0, children added: 0, parents added: 0, 
Net change: 1048 -> 1048 = << 0 >>, blacklisted: 517. 


Algorithm converged. Run-time of: 29.31 seconds.

Plotting Figures...
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/HJB.m',106,1)">106 </a>assert( max(max(abs( thetaF(G.n == param.nmax, :) - (G.muR-G.r)./(param.gamma*param.sigR2) ))) < num0 );
thetaF(G.n == param.nmax, :)

ans =

    0.8696    0.8696

(G.muR-G.r)./(param.gamma*param.sigR2)

ans =

    0.8696

if system_dependent('IsDebugMode')==1, dbquit; end
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

if system_dependent('IsDebugMode')==1, dbquit; end
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

if system_dependent('IsDebugMode')==1, dbquit all; end
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

if system_dependent('IsDebugMode')==1, dbcont; end
{Unrecognized field name "sigR".

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('HJB', '/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/HJB.m', 108)" style="font-weight:bold">HJB</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/HJB.m',108,0)">line 108</a>)
    - min((G.muR-G.r)./(param.gamma*(G.sigR).^2), 1 - param.nmin./G.n(end)) ))) < num0 );

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('VFI', '/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/VFI.m', 13)" style="font-weight:bold">VFI</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/VFI.m',13,0)">line 13</a>)
hjb = HJB(V, G, param);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('stationary', '/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/stationary.m', 38)" style="font-weight:bold">stationary</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/stationary.m',38,0)">line 38</a>)
[V, hjb] = VFI(G, [], param);

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('main', '/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/main.m', 80)" style="font-weight:bold">main</a> (<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/main.m',80,0)">line 80</a>)
    [diff0, G, G_dense, ~] = stationary(X0, G, G_dense, param);
} 
main
Running algorithm:


 -------  GRID ADAPTATION ITERATION 1  ------- 

if system_dependent('IsDebugMode')==1, dbcont; end
<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/HJB.m',107,1)">107 </a>assert( max(max(abs( thetaF(G.n == param.nmax, :) ...
if system_dependent('IsDebugMode')==1, dbcont; end
<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/HJB.m',107,1)">107 </a>assert( max(max(abs( thetaF(G.n == param.nmax, :) ...
if system_dependent('IsDebugMode')==1, dbcont; end
<a href="matlab: opentoline('/Users/andreasschaab/Dropbox/Schaab-Lab/SparseEcon/use_cases/04_two_assets_risky/01_idiosyncratic_risk/HJB.m',107,1)">107 </a>assert( max(max(abs( thetaF(G.n == param.nmax, :) ...
if system_dependent('IsDebugMode')==1, dbquit; end
